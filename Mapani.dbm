<?xml version="1.0" encoding="UTF-8"?>
<!--
CAUTION: Do not modify this file unless you know what you are doing.
 Unexpected results may occur if the code is changed deliberately.
-->
<dbmodel pgmodeler-ver="1.0.0-beta1" use-changelog="false" last-position="0,0" last-zoom="1" max-obj-count="122"
	 default-schema="public" default-owner="postgres"
	 layers="Default layer"
	 active-layers="0"
	 layer-name-colors="#000000"
	 layer-rect-colors="#b4b4b4"
	 show-layer-names="false" show-layer-rects="false">
<role name="krash"
 createdb="true"
 createrole="true"
 inherit="true"
 login="true"
 password="********">
</role>

<role name="primaryuser"
 replication="true"
 inherit="true"
 login="true"
 password="********">
</role>

<database name="mapani_enhd" encoding="UTF8" lc-collate="en_US.UTF8" lc-ctype="en_US.UTF8" is-template="false" allow-conns="true">
	<role name="krash"/>
	<tablespace name="pg_default"/>
</database>

<schema name="public" layers="0" rect-visible="true" fill-color="#e1e1e1" sql-disabled="true">
</schema>

<sequence name="document_type_sequence" cycle="false" start="1" increment="1" min-value="0" max-value="32767" cache="1">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="users" layers="0" collapse-mode="2" max-obj-count="14" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="60"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="username">
		<type name="character varying" length="30"/>
	</column>
	<column name="password">
		<type name="character varying" length="150"/>
	</column>
	<column name="email" not-null="true">
		<type name="character varying" length="150"/>
	</column>
	<column name="security_code">
		<type name="character varying" length="150"/>
	</column>
	<column name="recuperate_password_token">
		<type name="character varying" length="50"/>
	</column>
	<column name="personal_data_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="status_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="role_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="users_pk" type="pk-constr" table="public.users">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="users_uk" type="uq-constr" table="public.users">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="users_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="users_status" layers="0" collapse-mode="2" max-obj-count="7" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="560" y="60"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<column name="delete" default-value="false">
		<type name="boolean" length="0"/>
	</column>
	<constraint name="users_status_pk" type="pk-constr" table="public.users_status">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="users_status_uk" type="uq-constr" table="public.users_status">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="users_status_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="users_role" layers="0" collapse-mode="2" max-obj-count="7" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="960" y="60"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<column name="delete" default-value="false">
		<type name="boolean" length="0"/>
	</column>
	<constraint name="users_role_pk" type="pk-constr" table="public.users_role">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="users_role_uk" type="uq-constr" table="public.users_role">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="users_role_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="role_module_permission" layers="0" collapse-mode="2" max-obj-count="12" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1360" y="60"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="role_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="module_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="show" not-null="true" default-value="false">
		<type name="boolean" length="0"/>
	</column>
	<column name="create" not-null="true" default-value="false">
		<type name="boolean" length="0"/>
	</column>
	<column name="update" not-null="true" default-value="false">
		<type name="boolean" length="0"/>
	</column>
	<column name="print" not-null="true" default-value="false">
		<type name="boolean" length="0"/>
	</column>
	<column name="report" not-null="true" default-value="false">
		<type name="boolean" length="0"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="role_module_permission_pk" type="pk-constr" table="public.role_module_permission">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="role_module_permission_uk" type="uq-constr" table="public.role_module_permission">
		<columns names="role_code,module_code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="role_module_permission_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="modules" layers="0" collapse-mode="2" max-obj-count="13" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1840" y="60"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="src">
		<type name="character varying" length="50"/>
	</column>
	<column name="icon">
		<type name="character varying" length="50"/>
	</column>
	<column name="unabled" default-value="false">
		<type name="boolean" length="0"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<column name="haschildren" default-value="false">
		<type name="boolean" length="0"/>
	</column>
	<column name="order" default-value="0">
		<type name="integer" length="0"/>
	</column>
	<column name="fathercode" default-value="NULL">
		<type name="character varying" length="15"/>
	</column>
	<constraint name="module_pk" type="pk-constr" table="public.modules">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="module_uk" type="uq-constr" table="public.modules">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="modules_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="representative" layers="0" collapse-mode="2" max-obj-count="22" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="580"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="firstName" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="lastName" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="gender_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="document_type_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="dni" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="born_date" not-null="true">
		<type name="date" length="0"/>
	</column>
	<column name="martial_status_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="own_income" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="disability" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="disability_type_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="ethnic_group" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="ethnic_description">
		<type name="character varying" length="60"/>
	</column>
	<column name="parrish_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="direction" not-null="true">
		<type name="character varying" length="150"/>
	</column>
	<column name="phone_number">
		<type name="character varying" length="15"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="representative_pk" type="pk-constr" table="public.representative">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="representative_uk" type="uq-constr" table="public.representative">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="representative_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="patient" layers="0" collapse-mode="2" max-obj-count="21" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="520" y="580"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="firstName" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="lastName" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="born_date" not-null="true">
		<type name="date" length="0"/>
	</column>
	<column name="gender_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="birth_certificate" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="disability" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="smallint" length="0"/>
	</column>
	<column name="cero_to_five">
		<type name="smallint" length="0"/>
	</column>
	<column name="six_to_teen">
		<type name="smallint" length="0"/>
	</column>
	<column name="eleven_to_seventeen">
		<type name="smallint" length="0"/>
	</column>
	<column name="mobilization_condition_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="parrish_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="direction" not-null="true">
		<type name="character varying" length="100"/>
	</column>
	<column name="contact_number" not-null="true">
		<type name="character varying" length="20"/>
	</column>
	<column name="disability_description">
		<type name="character varying" length="100"/>
	</column>
	<constraint name="patient_pk" type="pk-constr" table="public.patient">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="patient_uk" type="uq-constr" table="public.patient">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="patient_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="document_type" layers="0" collapse-mode="2" max-obj-count="7" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1040" y="580"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<column name="acronym" not-null="true">
		<type name="character" length="1"/>
	</column>
	<constraint name="document_type_pk" type="pk-constr" table="public.document_type">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="document_type_uk" type="uq-constr" table="public.document_type">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="document_type_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="gender" layers="0" collapse-mode="2" max-obj-count="6" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1440" y="580"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="20"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="gender_pk" type="pk-constr" table="public.gender">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="gender_uk" type="uq-constr" table="public.gender">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="gender_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="martial_status" layers="0" collapse-mode="2" max-obj-count="6" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1840" y="580"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="20"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="martial_status_pk" type="pk-constr" table="public.martial_status">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="martial_status_uk" type="uq-constr" table="public.martial_status">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="martial_status_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="disability_type" layers="0" collapse-mode="2" max-obj-count="6" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="1320"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="20"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="disability_type_pk" type="pk-constr" table="public.disability_type">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="disability_type_uk" type="uq-constr" table="public.disability_type">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="disability_type_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="stade" layers="0" collapse-mode="2" max-obj-count="7" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="460" y="1320"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="20"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<column name="region_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<constraint name="stade_pk" type="pk-constr" table="public.stade">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="stade_uk" type="uq-constr" table="public.stade">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="stade_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="municipality" layers="0" collapse-mode="2" max-obj-count="7" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="860" y="1320"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="stade_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="60"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="municipality_pk" type="pk-constr" table="public.municipality">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="municipality_uk" type="uq-constr" table="public.municipality">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="municipality_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="parrish" layers="0" collapse-mode="2" max-obj-count="7" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1280" y="1320"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="municipality_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="60"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="parrish_pk" type="pk-constr" table="public.parrish">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="parrish_uk" type="uq-constr" table="public.parrish">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="parrish_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="clinic_history" layers="0" collapse-mode="2" max-obj-count="12" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1720" y="1320"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="project_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="patient_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="muac_information" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="breastfeeding" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="hemocue">
		<type name="smallint" length="0"/>
	</column>
	<column name="hemocute_date">
		<type name="date" length="0"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="clinic_history_pk" type="pk-constr" table="public.clinic_history">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="clinic_history_uk" type="uq-constr" table="public.clinic_history">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="clinic_history_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="reception_agenda" layers="0" collapse-mode="2" max-obj-count="27" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="1780"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="Appointment_date" not-null="true">
		<type name="date" length="0"/>
	</column>
	<column name="pediatrics" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="nutritionist" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="psychiatry" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="breastfeeding_advice" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="advocacy" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="next_appointment">
		<type name="date" length="0"/>
	</column>
	<column name="clinic_history_code" default-value="NULL">
		<type name="character varying" length="15"/>
	</column>
	<column name="representative_firstName" default-value="NULL">
		<type name="character varying" length="20"/>
	</column>
	<column name="representative_lastName" default-value="NULL">
		<type name="character varying" length="20"/>
	</column>
	<column name="representative_numberPhone" default-value="NULL">
		<type name="character varying" length="20"/>
	</column>
	<column name="representative_direction" default-value="NULL">
		<type name="character varying" length="50"/>
	</column>
	<column name="patient_firstName" default-value="NULL">
		<type name="character varying" length="20"/>
	</column>
	<column name="patient_lastName" default-value="NULL">
		<type name="character varying" length="20"/>
	</column>
	<column name="patient_bornDate">
		<type name="date" length="0"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<column name="project_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="social_psychology" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="clinical_psychology" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="status" default-value="0">
		<type name="integer" length="0"/>
	</column>
	<constraint name="reception_agenda_pk" type="pk-constr" table="public.reception_agenda">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="reception_agenda_uk" type="uq-constr" table="public.reception_agenda">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="reception_agenda_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="project" layers="0" collapse-mode="2" max-obj-count="15" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="580" y="1780"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="20"/>
	</column>
	<column name="acronym" not-null="true">
		<type name="character varying" length="5"/>
	</column>
	<column name="start_date" not-null="true">
		<type name="date" length="0"/>
	</column>
	<column name="due_date" not-null="true">
		<type name="date" length="0"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<column name="min_years_old" not-null="true">
		<type name="character varying" length="30"/>
	</column>
	<column name="max_years_old" not-null="true">
		<type name="character varying" length="30"/>
	</column>
	<column name="from_day">
		<type name="&quot;char&quot;" length="0"/>
	</column>
	<column name="to_day">
		<type name="&quot;char&quot;" length="0"/>
	</column>
	<column name="one_day" not-null="true" default-value="false">
		<type name="boolean" length="0"/>
	</column>
	<constraint name="project_pk" type="pk-constr" table="public.project">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="project_uk" type="uq-constr" table="public.project">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="project_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="nursing" layers="0" collapse-mode="2" max-obj-count="15" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1020" y="1780"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="clinic_history_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="sizes_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="weight_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="marasmo" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="kwashiorkor" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="referred" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="egress_date">
		<type name="date" length="0"/>
	</column>
	<column name="exit_status_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="weight">
		<type name="double precision" length="0"/>
	</column>
	<column name="size">
		<type name="double precision" length="0"/>
	</column>
	<column name="t_e_zscore">
		<type name="double precision" length="0"/>
	</column>
	<column name="p_t_zscore">
		<type name="double precision" length="0"/>
	</column>
	<constraint name="nursing_pk" type="pk-constr" table="public.nursing">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="nursing_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="sizes" layers="0" collapse-mode="2" max-obj-count="7" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1460" y="1780"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
	<column name="size_range">
		<type name="character varying" length="10"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="sizes_pk" type="pk-constr" table="public.sizes">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="sizes_uk" type="uq-constr" table="public.sizes">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="sizes_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="weight" layers="0" collapse-mode="2" max-obj-count="6" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1880" y="1780"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="weight_pk" type="pk-constr" table="public.weight">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="weight_uk" type="uq-constr" table="public.weight">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="weight_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="exit_status" layers="0" collapse-mode="2" max-obj-count="6" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="2580"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="exit_status_pk" type="pk-constr" table="public.exit_status">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="exit_status_uk" type="uq-constr" table="public.exit_status">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="exit_status_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="3phase" layers="0" collapse-mode="2" max-obj-count="10" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="440" y="2580"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="clinic_history_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="weight">
		<type name="double precision" length="0"/>
	</column>
	<column name="size">
		<type name="double precision" length="0"/>
	</column>
	<column name="muac">
		<type name="double precision" length="0"/>
	</column>
	<column name="p_t_zscore">
		<type name="double precision" length="0"/>
	</column>
	<column name="t_e_zscore">
		<type name="double precision" length="0"/>
	</column>
	<column name="growth_monitoring_status_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="diagnosis">
		<type name="character varying" length="50"/>
	</column>
	<constraint name="3phase_pk" type="pk-constr" table="public.&quot;3phase&quot;">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="3phase_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="grown_monitoring_status" layers="0" collapse-mode="2" max-obj-count="6" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="940" y="2580"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="grown_monitoring_status_pk" type="pk-constr" table="public.grown_monitoring_status">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="grown_monitoring_status_uk" type="uq-constr" table="public.grown_monitoring_status">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="grown_monitoring_status_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="babysitter" layers="0" collapse-mode="2" max-obj-count="8" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1360" y="2580"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="patient_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="representative_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="relationship_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<constraint name="babysitter_pk" type="pk-constr" table="public.babysitter">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="babysitter_uk" type="uq-constr" table="public.babysitter">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="babysitter_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<function name="calyearsolds"
		window-func="false"
		returns-setof="false"
		behavior-type="CALLED ON NULL INPUT"
		function-type="VOLATILE"
		security-type="SECURITY INVOKER"
		parallel-type="PARALLEL UNSAFE"
		execution-cost="100"
		row-amount="0">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<return-type>
	<type name="character varying" length="0"/>
	</return-type>
	<parameter name="_bornDate">
		<type name="date" length="0"/>
	</parameter>
	<definition> <![CDATA[declare
age character varying;
begin
SELECT age(CURRENT_DATE, "_bornDate") into age;
return age;
end;]]> </definition>
</function>

<function name="findAppointmentDate"
		window-func="false"
		returns-setof="false"
		behavior-type="CALLED ON NULL INPUT"
		function-type="VOLATILE"
		security-type="SECURITY INVOKER"
		parallel-type="PARALLEL UNSAFE"
		execution-cost="100"
		row-amount="0">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<return-type>
	<type name="record" length="0"/>
	</return-type>
	<parameter name="_Birthdate">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[DECLARE
    var record;
    response record;
    i int := 1;
    "dueDate" date;
    "auxDate" date;
    "fromDay" int;
    "toDay" int;
    max_appointment_date_per_day int := 2;
    count_appointment_date_per_day int := 0;
BEGIN
    FOR var IN
    SELECT
       	vp.code,
       	vp."minYearsOld",
       	vp."maxYearsOld",
       	vp."startDate",
       	vp."dueDate",
        vp."fromDay",
        vp."toDay"
    FROM
        public.view_project vp
    WHERE
         vp."dueDate" > CURRENT_DATE LOOP
            --- verificamos que la edad proporcionada este dentro de los parametros de los proyectos
            IF NOT "_Birthdate"::interval BETWEEN var."minYearsOld"::interval AND var."maxYearsOld"::interval THEN
                CONTINUE;
            END IF;
            --- buscamos una fecha dentro de los parametros
            "dueDate" := var."dueDate";
            "auxDate" := var."startDate" - 1;
            "fromDay" := var."fromDay";
            "toDay" := var."toDay";
            LOOP
                --- incrementamos la fecha para encontrar una fecha adecuada para las citas proximas
                "auxDate" := "auxDate" + 1;
                --- verificamos que la fecha auxiliar no sea menor que la fecha presente
            	CONTINUE when "auxDate" < CURRENT_DATE;
                --- verificamos que la fecha no este por encima de la fecha de expiracion del proyecto
                IF "auxDate" > "dueDate" THEN
                    SELECT
                        1::int,
                        'No se encontro una fecha'::character varying,
                        NULL::character varying,
                        NULL::date INTO response;
                    exit;
                END IF;
                --- verificamos que el conjunto de dias este dentro de los parametros establecidos
                IF NOT to_char("auxDate", 'd')::int BETWEEN "fromDay"::int AND "toDay"::int THEN
                    CONTINUE;
                END IF;
                --- buscamos cuantas citas existen en la fecha auxiliar
                SELECT
                    count(*) INTO count_appointment_date_per_day
                FROM
                    view_appointment
                WHERE
                    "appointmentDate" = "auxDate"::date;
                --- verificamos que el contador de citas por dia  no sea mayor al establecido por dias
                IF count_appointment_date_per_day >= max_appointment_date_per_day THEN
                    CONTINUE;
                END IF;
                --- enviamos el codigo, fecha de la cita y un mensaje de confirmacion 
                SELECT
                    0::int,
                    'success'::character varying,
                    var.code::character varying,
                    "auxDate"::date INTO response;
                exit;
            END LOOP;
            RETURN response;
        END LOOP;
    SELECT
        1::int,
        'sin coincidencias'::character varying,
        NULL::character varying,
        NULL::date INTO response;
    RETURN response;
END;]]> </definition>
</function>

<procedure name="add_appointment" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_pediatrics">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_nutritionist">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_psychiatry">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_breastfeeding_advice">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_advocacy">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_social_psychology">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_clinical_psychology">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_clinic_history_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_representative_firstName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_representative_lastName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_representative_numberPhone">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_representative_direction">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_patient_firstName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_patient_lastName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_patient_bornDate">
		<type name="date" length="0"/>
	</parameter>
	<definition> <![CDATA[DECLARE 
code character varying;
code_type character varying := 'ra';
appointment_data record;
proyect_code character varying;
appointment_date date;
BEGIN
    
  
for appointment_data in select * from "findAppointmentDate"(
	age(current_date,"_patient_bornDate")::character varying
) as f(status int, message character varying, code character varying, "appointmentDate" date) loop
    if appointment_data.status = 1 then
        RAISE EXCEPTION  '%s',appointment_data.message USING HINT = 'EXCEPTION is raised here and transaction aborted';
        exit;
    end if;
    appointment_date := appointment_data."appointmentDate";
    proyect_code:= appointment_data.code;
end loop;
code := codegen (code_type);
if _clinic_history_code is NULL then
    INSERT INTO public.reception_agenda(
        code,
        project_code,
        "Appointment_date",
        pediatrics,
        nutritionist,
        psychiatry,
        breastfeeding_advice,
        advocacy,
        social_psychology,
        clinical_psychology,
        "representative_firstName",
        "representative_lastName",
        "representative_numberPhone",
        representative_direction,
        "patient_firstName",
        "patient_lastName",
        "patient_bornDate"
       )
        VALUES (
        code,
        proyect_code,
        appointment_date,
        _pediatrics,
        _nutritionist,
        _psychiatry,
        _breastfeeding_advice,
        _advocacy,
        _social_psychology,
        _clinical_psychology,
        "_representative_firstName",
        "_representative_lastName",
        "_representative_numberPhone",
        "_representative_direction",
        "_patient_firstName",
        "_patient_lastName",
        "_patient_bornDate");
 else
   INSERT INTO public.reception_agenda(
        code,
        project_code,
        "Appointment_date",
        pediatrics,
        nutritionist,
        psychiatry,
        breastfeeding_advice,
        advocacy,
        social_psychology,
        clinical_psychology,
        clinic_history_code
       )
        VALUES (
        code,
        proyect_code,
        appointment_date,
        _pediatrics,
        _nutritionist,
        _psychiatry,
        _breastfeeding_advice,
        _advocacy,
        _social_psychology,
        _clinical_psychology,
        _clinic_history_code
        );
 end if;
END;]]> </definition>
</procedure>

<procedure name="add_gender" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[declare
code character varying;
code_type character varying := 'gndr';
begin
    code := codegen(code_type);
    
    INSERT INTO public.gender(
	code, name)
	VALUES (
        code,
        _name
    );
end;]]> </definition>
</procedure>

<procedure name="add_disability_type" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[declare
code character varying;
code_type character varying := 'dsbltyType';
begin
    code := codegen(code_type);
    
    INSERT INTO public.disability_type(
	code, name)
	VALUES (code,_name);
    
end;]]> </definition>
</procedure>

<table name="patient_disability" layers="0" collapse-mode="2" max-obj-count="9" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1820" y="2580"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="patient_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<column name="motor" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="visual" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="cognitive" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="auditive" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<constraint name="patient_disability_pk" type="pk-constr" table="public.patient_disability">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="patient_disability_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<function name="codegen"
		window-func="false"
		returns-setof="false"
		behavior-type="CALLED ON NULL INPUT"
		function-type="VOLATILE"
		security-type="SECURITY INVOKER"
		parallel-type="PARALLEL UNSAFE"
		execution-cost="100"
		row-amount="0">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<return-type>
	<type name="character varying" length="0"/>
	</return-type>
	<parameter name="code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_acronym" default-value="NULL::character varying">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[DECLARE
count_code integer := 0;
BEGIN
	if code = 'ra' then
		--
		select count(*) into count_code from public.reception_agenda;
        return concat('RA-' , substring('0000000',length(count_code::character varying) + 1, 7),count_code + 1);
    elsif code = 'prjt' then
    	-- project
        select count(*) into count_code from public.project where acronym = _acronym;
        return concat(_acronym , count_code+1);
    elsif code = 'DType' then
    	-- project
        select count(*) into count_code from public.document_type ;
       return concat('DTYPE-' , substring('00',length(count_code::character varying) + 1, 2),count_code + 1);
    elsif code = 'gndr' then
    	-- gender
        select count(*) into count_code from public.gender;
        return concat('GNDR-' , substring('00',length(count_code::character varying) + 1, 2),count_code + 1);
    ELSIF code = 'dsbltyType' then
    	-- disability type
        select count(*) into count_code from public.disability_type;
        return concat('DSBLTYT-' , substring('00',length(count_code::character varying) + 1, 2),count_code + 1);
    elsif code = 'ptnt' then
    	--patient
        select count(*) into count_code from public.patient;
        return concat('MAPANI-' , substring('0000000',length(count_code::character varying) + 1, 7),count_code + 1);
    elsif code = 'spns' then
    	-- sponsor
        select count(*) into count_code from public.sponsors;
        return concat('SPNS-', substring('0000',length(count_code::character varying) + 1, 7),count_code + 1);
    elsif code = 'usr' then
    	-- users
    	select count(*) into count_code from public.users;
    	return concat('USR-', substring('000000',length(count_code::character varying) + 1,7),count_code + 1);
    elsif code = 'usrRole' then
    	-- user role
    	select count(*) into count_code from users_role;
    	return concat('ROL-', substring('0000',length(count_code::character varying) + 1, 4),count_code + 1);
    elsif code = 'usrStatus' then
    	--user status
    	select count(*) into count_code from public.users_status;
    	return concat('STTS-', substring('0000', length(count_code::character varying) + 1, 4), count_code + 1);
    elsif code = 'module' then
    	-- modules
    	select count(*) into count_code from public."modules";
    	return concat('MOD-', substring('0000',length(count_code::character varying) + 1, 4), count_code + 1);
    elsif code = 'upd' then
    	-- user personal data
    	select count(*) into count_code from public.user_personal_data;
    	return concat('UPD-', substring('0000',length(count_code::character varying) + 1, 4), count_code + 1);
    elsif code = 'Mstatus' then
    	-- martial status
    	select count(*) into count_code from public.martial_status;
    	return concat('MSTTS-', substring('0000',length(count_code::character varying) + 1, 4), count_code + 1);
    elsif code = 'DPTM' then
    	-- departament
    	select count(*) into count_code from public.departament;
    	return concat('DPTMT-', substring('0000',length(count_code::character varying) + 1, 4), count_code + 1);
    elsif code = 'JOBPOSI' then
    	-- job position
    	select count(*) into count_code from public.job_position;
    	return concat('JBPST-', substring('0000',length(count_code::character varying) + 1, 4), count_code + 1);
    elsif code = 'EMPL' then
    	-- employed
    	select count(*) into count_code from public.employed;
    	return concat('EMP-', substring('0000',length(count_code::character varying) + 1, 4), count_code + 1);
    else
        return 'codigo no existe';
	end if;
END;]]> </definition>
</function>

<table name="sponsors" layers="0" collapse-mode="2" max-obj-count="10" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="3000"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="20"/>
	</column>
	<column name="contac_number">
		<type name="character varying" length="20"/>
	</column>
	<column name="email">
		<type name="character varying" length="50"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<column name="rif" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="document_type_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<constraint name="sponsors_pk" type="pk-constr" table="public.sponsors">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="sponsors_uk" type="uq-constr" table="public.sponsors">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="sponsors_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="sponsors_by_project" layers="0" collapse-mode="2" max-obj-count="7" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="520" y="3000"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="sponsor_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="project_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<column name="delete" default-value="false">
		<type name="boolean" length="0"/>
	</column>
	<constraint name="sponsors_by_project_pk" type="pk-constr" table="public.sponsors_by_project">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="sponsors_by_project_uk" type="uq-constr" table="public.sponsors_by_project">
		<columns names="sponsor_code,project_code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="sponsors_by_project_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<procedure name="add_patient" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_firstName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_lastName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_born_date">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_gender_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_birth_certificate">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_disability">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_motor">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_visual">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_cognitive">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_auditive">
		<type name="boolean" length="0"/>
	</parameter>
	<definition> <![CDATA[declare
code character varying;
code_type character varying := 'ptnt';
disability_selected boolean := false;
begin
    if _code is null then
        code := codegen(code_type);
    else
        code := concat('MAPANI-' , substring('0000000',length(_code::character varying) + 1, 7),_code+1);
    end if;
	
	if _motor = true or _visual = true or _cognitive = true or _auditive = true then
		disability_selected := true;
	end if;
    
    if _disability = true and disability_selected = false then
        RAISE EXCEPTION  'no existe ninguna discapacidad que agregar' USING HINT = 'EXCEPTION is raised here and transaction aborted';
    end if;
        
    
    INSERT INTO public.patient(
    code, 
        "firstName",
        "lastName",
        born_date,
        gender_code,
        birth_certificate,
        disability
       )
	VALUES (
        code,
        "_firstName",
        "_lastName",
        _born_date,
        _gender_code,
        _birth_certificate,
        _disability
    );
    
    if _disability = true then
        INSERT INTO public."patient_disability"(
		patient_code, motor, visual, cognitive, auditive
		)
         values (
			code,
			_motor,
			_visual,
			_cognitive,
			_auditive);
		
		/*
		INSERT INTO public.patient_disability(
        patient_code, motor,visual,cognitive,auditive) SELECT code , "code_type"::character varying  FROM unnest( _disability_type) AS "code_type";
		*/
    end if;
end;]]> </definition>
</procedure>

<procedure name="update_patient" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_firstName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_lastName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_born_date">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_gender_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_birth_certificate">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_disability">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_motor">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_visual">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_cognitive">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_auditive">
		<type name="boolean" length="0"/>
	</parameter>
	<definition> <![CDATA[declare
disability_selected boolean := false;
begin
	if _motor = true or _visual = true or _cognitive = true or _auditive = true then
		disability_selected := true;
	end if;
	
    if _disability = true  and disability_selected = false then
        RAISE EXCEPTION  'no existe ninguna discapacidad que agregar' USING HINT = 'EXCEPTION is raised here and transaction aborted';
    end if;
        
    
	UPDATE public.patient
	SET  
	code = _code,
	"firstName"="_firstName",
	"lastName"="_lastName",
	born_date=_born_date,
	gender_code=_gender_code,
	birth_certificate=_birth_certificate,
	disability=_disability
	WHERE code = _code;
	
    
    if _disability = true then
        UPDATE public.patient_disability
		SET  
		patient_code = _code,
		motor=_motor,
		visual=_visual,
		cognitive=_cognitive,
		auditive=_auditive
		WHERE patient_code = _code;
    end if;
end;]]> </definition>
</procedure>

<function name="update_appointment_trigger"
		window-func="false"
		returns-setof="false"
		behavior-type="CALLED ON NULL INPUT"
		function-type="VOLATILE"
		security-type="SECURITY INVOKER"
		parallel-type="PARALLEL UNSAFE"
		execution-cost="100"
		row-amount="0">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<return-type>
	<type name="trigger" length="0"/>
	</return-type>
	<definition> <![CDATA[declare
appointment_data record;
_project_code character varying;
appointment_date date;
begin
	if new."patient_bornDate" <> old."patient_bornDate" then
		for appointment_data in select * from "findAppointmentDate"(
			age(current_date, new."patient_bornDate")::character varying
		) as f(status int, message character varying, code character varying, "appointmentDate" date) loop
			if appointment_data.status = 1 then
				RAISE EXCEPTION  '%s',appointment_data.message USING HINT = 'EXCEPTION is raised here and transaction aborted';
				exit;
			end if;
			
			appointment_date := appointment_data."appointmentDate";
			_project_code := appointment_data.code;
			
			exit;
		end loop;
		if old.project_code <> _project_code and new."Appointment_date" = old."Appointment_date" then
		
			new.project_code := _project_code;
			new."Appointment_date":= appointment_date;
			new.update_at = current_timestamp;
			
		elsif old.project_code <> _project_code and new."Appointment_date" <> old."Appointment_date" then
			
			new.project_code := _project_code;
			new.update_at := current_timestamp;
			
		end if;
	elsif new.clinic_history_code <> null::character varying and old.clinic_history_code = null::character varying then
	
			new.clinic_history_code := new.clinic_history_code;
			new.update_at := current_timestamp;
			
	elsif new.clinic_history_code = null::character varying and old.clinic_history_code <> null::character varyingthen then
	
 		new.clinic_history_code := null::character varying;
		new.update_at := current_timestamp;
		
	end if;
	
	RETURN NEW;
	
end;]]> </definition>
</function>

<procedure name="update_appointment" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_project_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_appointmentDate">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_pediatrics">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_nutritionist">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_psychiatry">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_breastfeedingAdvice">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_advocacy">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_socialPsychology">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_clinicalPsychology">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_clinicHistoryCode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_representativeFirstName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_representativeLastName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_representativeNumberPhone">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_representativeDirection">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_patientFirstName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_patientLastName">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_patientBornDate">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_status">
		<type name="integer" length="0"/>
	</parameter>
	<definition> <![CDATA[begin
     if _code is NULL then
        RAISE EXCEPTION 'el codigo no puede estar vacio' USING HINT = 'EXCEPTION is raised here and transaction aborted';
     end if;
     UPDATE public.reception_agenda
			SET 
			project_code = _project_code,
			"Appointment_date"="_appointmentDate",
			pediatrics=_pediatrics,
			nutritionist=_nutritionist,
			psychiatry=_psychiatry,
			breastfeeding_advice="_breastfeedingAdvice",
			advocacy=_advocacy,
			social_psychology="_socialPsychology",
			clinical_psychology="_clinicalPsychology",
			clinic_history_code="_clinicHistoryCode",
			"representative_firstName"="_representativeFirstName",
			"representative_lastName"="_representativeLastName",
			"representative_numberPhone"="_representativeNumberPhone",
			representative_direction="_representativeDirection",
			"patient_firstName"="_patientFirstName",
			"patient_lastName"="_patientLastName",
			"patient_bornDate"="_patientBornDate",
			update_at = now(),
			status=_status
			WHERE code=_code;
end;]]> </definition>
</procedure>

<procedure name="add_user_status" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	declare 
		code character varying;
		code_type character varying := 'usrStatus';
	BEGIN
		
		code := codegen(code_type);
		
		insert into public.users_status (
			code,
			name
		) values (
			code,
			_name
		);
	END;]]> </definition>
</procedure>

<table name="user_personal_data" layers="0" collapse-mode="2" max-obj-count="21" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="960" y="3000"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="first_name" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="last_name" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="gender_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="document_type_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="dni" not-null="true">
		<type name="character varying" length="14"/>
	</column>
	<column name="born_date" not-null="true">
		<type name="date" length="0"/>
	</column>
	<column name="martial_status_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="disability" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="disability_type_code">
		<type name="character varying" length="15"/>
	</column>
	<column name="ethnic_group" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="ethnic_description">
		<type name="character varying" length="60"/>
	</column>
	<column name="parrish_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="direction" not-null="true">
		<type name="character varying" length="150"/>
	</column>
	<column name="phone_number">
		<type name="character varying" length="15"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="user_personal_data_pk" type="pk-constr" table="public.user_personal_data">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="user_personal_data_uk" type="uq-constr" table="public.user_personal_data">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="user_personal_data_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<trigger name="update_reception_agenda_trigger" firing-type="BEFORE" per-line="true" constraint="false"
	 ins-event="false" del-event="false" upd-event="true" trunc-event="false"
	 table="public.reception_agenda">
		<function signature="public.update_appointment_trigger()"/>
</trigger>

<view name="view_gender" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="4220"/>
	<reference>
		<expression> <![CDATA[ SELECT gender.code,
    gender.name
   FROM gender;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
		<reftable name="public.gender"/>
	</reference>
</view>

<relationship name="rel_view_gender_gender" type="reltv" layers="0"
	 custom-color="#932c7b"
	 src-table="public.view_gender"
	 dst-table="public.gender"
	 src-required="false" dst-required="false"/>

<view name="view_patient" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="360" y="4220"/>
	<reference>
		<expression> <![CDATA[ SELECT patient.code,
    patient."firstName",
    patient."lastName",
    patient.born_date AS "bornDate",
    gender.name AS gender,
    gender.code AS "genderCode",
    patient.birth_certificate AS "birthCertificate",
    patient.disability,
    patient_disability.motor,
    patient_disability.visual,
    patient_disability.cognitive,
    patient_disability.auditive
   FROM ((patient
     JOIN gender ON (((gender.code)::text = (patient.gender_code)::text)))
     LEFT JOIN patient_disability ON (((patient_disability.patient_code)::text = (patient.code)::text)))
  ORDER BY patient.code;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="firstName">
		<type name="character varying" length="50"/>
	</column>
	<column name="lastName">
		<type name="character varying" length="50"/>
	</column>
	<column name="bornDate">
		<type name="date" length="0"/>
	</column>
	<column name="gender">
		<type name="character varying" length="20"/>
	</column>
	<column name="genderCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="birthCertificate">
		<type name="boolean" length="0"/>
	</column>
	<column name="disability">
		<type name="boolean" length="0"/>
	</column>
	<column name="motor">
		<type name="boolean" length="0"/>
	</column>
	<column name="visual">
		<type name="boolean" length="0"/>
	</column>
	<column name="cognitive">
		<type name="boolean" length="0"/>
	</column>
	<column name="auditive">
		<type name="boolean" length="0"/>
	</column>
		<reftable name="public.patient"/>
		<reftable name="public.gender"/>
		<reftable name="public.patient_disability"/>
	</reference>
</view>

<relationship name="rel_view_patient_patient" type="reltv" layers="0"
	 custom-color="#f3ce24"
	 src-table="public.view_patient"
	 dst-table="public.patient"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_patient_gender" type="reltv" layers="0"
	 custom-color="#a663b7"
	 src-table="public.view_patient"
	 dst-table="public.gender"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_patient_patient_disability" type="reltv" layers="0"
	 custom-color="#5053e8"
	 src-table="public.view_patient"
	 dst-table="public.patient_disability"
	 src-required="false" dst-required="false"/>

<view name="view_appointment" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="720" y="4220"/>
	<reference>
		<expression> <![CDATA[ SELECT reception_agenda.code,
    reception_agenda.project_code AS "projectCode",
    reception_agenda."Appointment_date" AS "appointmentDate",
    reception_agenda.pediatrics,
    reception_agenda.nutritionist,
    reception_agenda.psychiatry,
    reception_agenda.breastfeeding_advice AS "breastfeedingAdvice",
    reception_agenda.advocacy,
    reception_agenda.social_psychology AS "socialPsychology",
    reception_agenda.clinical_psychology AS "clinicalPsychology",
    reception_agenda.next_appointment AS "nextAppointment",
    reception_agenda.clinic_history_code AS "clinicHistoryCode",
        CASE
            WHEN (reception_agenda.clinic_history_code IS NULL) THEN reception_agenda."representative_firstName"
            ELSE NULL::character varying
        END AS "representativeFirstName",
        CASE
            WHEN (reception_agenda.clinic_history_code IS NULL) THEN reception_agenda."representative_lastName"
            ELSE NULL::character varying
        END AS "representativeLastName",
        CASE
            WHEN (reception_agenda.clinic_history_code IS NULL) THEN reception_agenda."representative_numberPhone"
            ELSE NULL::character varying
        END AS "representativeNumberPhone",
        CASE
            WHEN (reception_agenda.clinic_history_code IS NULL) THEN reception_agenda.representative_direction
            ELSE NULL::character varying
        END AS "representativeDirection",
        CASE
            WHEN (reception_agenda.clinic_history_code IS NULL) THEN reception_agenda."patient_firstName"
            ELSE NULL::character varying
        END AS "patientFirstName",
        CASE
            WHEN (reception_agenda.clinic_history_code IS NULL) THEN reception_agenda."patient_lastName"
            ELSE NULL::character varying
        END AS "patientLastName",
        CASE
            WHEN (reception_agenda.clinic_history_code IS NULL) THEN reception_agenda."patient_bornDate"
            ELSE NULL::date
        END AS "patientBornDate",
    (reception_agenda.create_at)::date AS "aggregateIn",
    reception_agenda.status
   FROM reception_agenda
  ORDER BY reception_agenda.code DESC;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="projectCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="appointmentDate">
		<type name="date" length="0"/>
	</column>
	<column name="pediatrics">
		<type name="boolean" length="0"/>
	</column>
	<column name="nutritionist">
		<type name="boolean" length="0"/>
	</column>
	<column name="psychiatry">
		<type name="boolean" length="0"/>
	</column>
	<column name="breastfeedingAdvice">
		<type name="boolean" length="0"/>
	</column>
	<column name="advocacy">
		<type name="boolean" length="0"/>
	</column>
	<column name="socialPsychology">
		<type name="boolean" length="0"/>
	</column>
	<column name="clinicalPsychology">
		<type name="boolean" length="0"/>
	</column>
	<column name="nextAppointment">
		<type name="date" length="0"/>
	</column>
	<column name="clinicHistoryCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="representativeFirstName">
		<type name="character varying" length="0"/>
	</column>
	<column name="representativeLastName">
		<type name="character varying" length="0"/>
	</column>
	<column name="representativeNumberPhone">
		<type name="character varying" length="0"/>
	</column>
	<column name="representativeDirection">
		<type name="character varying" length="0"/>
	</column>
	<column name="patientFirstName">
		<type name="character varying" length="0"/>
	</column>
	<column name="patientLastName">
		<type name="character varying" length="0"/>
	</column>
	<column name="patientBornDate">
		<type name="date" length="0"/>
	</column>
	<column name="aggregateIn">
		<type name="date" length="0"/>
	</column>
	<column name="status">
		<type name="integer" length="0"/>
	</column>
		<reftable name="public.reception_agenda"/>
	</reference>
</view>

<relationship name="rel_view_appointment_reception_agenda" type="reltv" layers="0"
	 custom-color="#8a18ee"
	 src-table="public.view_appointment"
	 dst-table="public.reception_agenda"
	 src-required="false" dst-required="false"/>

<view name="view_project" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1180" y="4220"/>
	<reference>
		<expression> <![CDATA[ SELECT project.code,
    project.name,
    project.acronym,
    project.start_date AS "startDate",
    project.due_date AS "dueDate",
    project.min_years_old AS "minYearsOld",
    project.max_years_old AS "maxYearsOld",
    project.from_day AS "fromDay",
    project.to_day AS "toDay",
    project.one_day AS "isJustOneDay"
   FROM project;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
	<column name="acronym">
		<type name="character varying" length="5"/>
	</column>
	<column name="startDate">
		<type name="date" length="0"/>
	</column>
	<column name="dueDate">
		<type name="date" length="0"/>
	</column>
	<column name="minYearsOld">
		<type name="character varying" length="30"/>
	</column>
	<column name="maxYearsOld">
		<type name="character varying" length="30"/>
	</column>
	<column name="fromDay">
		<type name="&quot;char&quot;" length="0"/>
	</column>
	<column name="toDay">
		<type name="&quot;char&quot;" length="0"/>
	</column>
	<column name="isJustOneDay">
		<type name="boolean" length="0"/>
	</column>
		<reftable name="public.project"/>
	</reference>
</view>

<relationship name="rel_view_project_project" type="reltv" layers="0"
	 custom-color="#7a21d9"
	 src-table="public.view_project"
	 dst-table="public.project"
	 src-required="false" dst-required="false"/>

<view name="view_disability_type" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1540" y="4220"/>
	<reference>
		<expression> <![CDATA[ SELECT disability_type.code,
    disability_type.name
   FROM disability_type;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
		<reftable name="public.disability_type"/>
	</reference>
</view>

<relationship name="rel_view_disability_type_disability_type" type="reltv" layers="0"
	 custom-color="#8ed9ba"
	 src-table="public.view_disability_type"
	 dst-table="public.disability_type"
	 src-required="false" dst-required="false"/>

<procedure name="update_user_personal_data" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_first_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_last_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_gender_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_document_type_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_dni">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_born_date">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_martial_status_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_disability">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_disability_type_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_ethnic_group">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_ethnic_description">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_parrish_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_direction">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_phone_number">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	BEGIN
		UPDATE public.user_personal_data
		SET 
		first_name=_first_name,
		last_name=_last_name,
		gender_code=_gender_code,
		document_type_code=_document_type_code,
		dni=_dni, 
		born_date=_born_date, 
		martial_status_code=_martial_status_code, 
		disability=_disability, 
		disability_type_code=_disability_type_code, 
		ethnic_group=_ethnic_group, 
		ethnic_description=_ethnic_description, 
		parrish_code=_parrish_code, 
		direction=_direction, 
		phone_number=_phone_number, 
		update_at=now()
		WHERE code=_code;
	END;]]> </definition>
</procedure>

<procedure name="add_user_role" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_module_code">
		<type name="character varying" length="0" dimension="1"/>
	</parameter>
	<parameter name="_show">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_create">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_update">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_print">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_report">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<definition> <![CDATA[	declare 
		code character varying;
		code_type character varying := 'usrRole';
	BEGin
		code := codegen(code_type);
		insert into public.users_role (
			code,
			name
		) values (
			code,
			_name
		);
		-- agregate all module for this role and his permissions
		insert into public.role_module_permission (
			role_code,
			module_code,
			"show",
			"create",
			"update",
			print,
			report
		) SELECT code , *  FROM 
		unnest(_module_code) AS "module",
		unnest(_show) AS "show",
		unnest(_create) AS "create",
		unnest(_update) AS "update",
		unnest(_print) AS "print",
		unnest(_report) AS "report"
		group by "module", "show", "create", "update", "print", "report"
		order by "module" asc
		;
	END;]]> </definition>
</procedure>

<table name="employed" layers="0" collapse-mode="2" max-obj-count="10" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1440" y="3000"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="user_personal_data_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="date_of_entry" not-null="true">
		<type name="date" length="0"/>
	</column>
	<column name="date_of_discharge">
		<type name="date" length="0"/>
	</column>
	<column name="departament_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="job_position_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="employed_pk" type="pk-constr" table="public.employed">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="employed_uk" type="uq-constr" table="public.employed">
		<columns names="code,user_personal_data_code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="employed_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="job_position" layers="0" collapse-mode="2" max-obj-count="6" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1960" y="3000"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="job_position_pk" type="pk-constr" table="public.job_position">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="job_position_uk" type="uq-constr" table="public.job_position">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="job_position_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="departament" layers="0" collapse-mode="2" max-obj-count="6" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="3720"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="departament_pk" type="pk-constr" table="public.departament">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="departament_uk" type="uq-constr" table="public.departament">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="departament_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="modules_by_job_position_departament" layers="0" collapse-mode="2" max-obj-count="13" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="460" y="3720"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="module_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="job_position_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="departament_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="show" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="create" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="update" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="print" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="report" not-null="true">
		<type name="boolean" length="0"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="modules_by_job_position_departament_pk" type="pk-constr" table="public.modules_by_job_position_departament">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="modules_by_job_position_departament_uk_jP_d_m" type="uq-constr" table="public.modules_by_job_position_departament">
		<columns names="job_position_code,departament_code,module_code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="modules_by_job_position_departament_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<procedure name="add_permission_modules_by_departament" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_modules_codes">
		<type name="character varying" length="0" dimension="1"/>
	</parameter>
	<parameter name="_job_position_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_departament_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_show">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_create">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_update">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_print">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_report">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<definition> <![CDATA[	BEGIN
		insert into modules_by_job_position_departament as mbjbd (
			job_position_code ,
			departament_code ,
			module_code,
			"show",
			"create" ,
			"update" ,
			"print" ,
			"report" 
		) select * from (SELECT _job_position_code ,_departament_code ,  *  FROM 
		unnest(_modules_codes,
		_show,
		_create,
		_update,
		_print,
		_report)) as v(job_position_code,departament_code, "module","show","create","update","print","report")
		on conflict on constraint "modules_by_job_position_departament_uk_jP_d_m" do update 
			set ("show","create","update","print","report") = (EXCLUDED."show", EXCLUDED."create",excluded."update", EXCLUDED."print", EXCLUDED."report");
	END;]]> </definition>
</procedure>

<procedure name="add_role_modules_permission" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_role_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_module_code">
		<type name="character varying" length="0" dimension="1"/>
	</parameter>
	<parameter name="_show">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_create">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_update">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_print">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<parameter name="_report">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<definition> <![CDATA[	BEGIN
		insert into public."role_module_permission" (
			role_code,
			module_code,
			"show",
			"create",
			"update",
			print,
			report
		) (SELECT _role_code , *  FROM 
		unnest(_module_code) AS "module",
		unnest(_show) AS "show",
		unnest(_create) AS "create",
		unnest(_update) AS "update",
		unnest(_print) AS "print",
		unnest(_report) AS "report"
		group by "module", "show", "create", "update", "print", "report"
		order by "module" asc)
		ON CONFLICT (role_code,module_code) DO NOTHING
		;
	END;]]> </definition>
</procedure>

<procedure name="add_document_type" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_acronym">
		<type name="character" length="0"/>
	</parameter>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	declare
		code character varying;
		code_type character varying := 'DType';
	BEGIN
		code := public.codegen(code_type);
	
		INSERT INTO public.document_type
		(code, "acronym" ,"name")
		VALUES(code, _acronym ,_name);
	END;]]> </definition>
</procedure>

<table name="region" layers="0" collapse-mode="2" max-obj-count="6" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1040" y="3720"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="50"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="region_pk" type="pk-constr" table="public.region">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="region_uk" type="uq-constr" table="public.region">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="region_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<procedure name="add_martial_status" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	declare 
		code character varying;
		code_type character varying := 'Mstatus';
	BEGIN
		code := codegen(code_type);
		insert into public.martial_status (code, "name") values (code, _name);
	END;]]> </definition>
</procedure>

<procedure name="add_departament" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	declare
		code character varying;
		code_type character varying := 'DPTM';
	BEGIN
		code := codegen(code_type);
		insert into departament ( code, "name")
		values( code, _name);
	END;]]> </definition>
</procedure>

<procedure name="add_job_position" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	declare 
		code character varying;
		code_type character varying := 'JOBPOSI';
	BEGIN
		code := codegen(code_type);
		insert into job_position (code,"name")
		values (code,_name);
	END;]]> </definition>
</procedure>

<procedure name="add_user" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_user_personal_data_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_username">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_password">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_email">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_security_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_status_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_role_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_first_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_last_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_gender_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_document_type_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_dni">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_born_date">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_martial_status_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_disability">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_disability_type_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_ethnic_group">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_ethnic_description">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_parrish_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_direction">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_phone_number">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	declare 
		code character varying;
		
		code_type character varying := 'usr';
	
		upd_code character varying;
	
		upd_code_type character varying := 'upd';
	
		exist_upd int;
		
		
	begin
		
		if _user_personal_data_code is null then
			
			select count(*) into exist_upd from public.user_personal_data where dni = _dni;
		
			if exist_upd > 0 then
				raise exception 'cedula regristrada' USING HINT = 'EXCEPTION is raised here and transaction aborted';
			end if;
		
			code := codegen(code_type);
			upd_code := codegen(upd_code_type);
		
			insert into public.user_personal_data (
				code,
				first_name,
				last_name,
				gender_code, 
				document_type_code,
				dni,
				born_date,
				martial_status_code,
				disability,
				disability_type_code,
				ethnic_group,
				ethnic_description,
				parrish_code,
				direction,
				phone_number
			) values (
				upd_code,
				_first_name,
				_last_name,
				_gender_code, 
				_document_type_code,
				_dni,
				_born_date,
				_martial_status_code,
				_disability,
				_disability_type_code,
				_ethnic_group,
				_ethnic_description,
				_parrish_code,
				_direction,
				_phone_number
			);
		
			INSERT INTO public.users
			(
				code,
				username,
				"password",
				email,
				security_code,
				recuperate_password_token,
				personal_data_code,
				status_code,
				role_code
			)
			VALUES(
				code,
				_username,
				_password,
				_email,
				_security_code,
				'null'::character varying,
				upd_code, 
				_status_code,
				_role_code
			);
		else
			code := codegen(code_type);
			INSERT INTO public.users
				(
					code,
					username,
					"password",
					email,
					security_code,
					recuperate_password_token,
					personal_data_code,
					status_code,
					role_code
				)
				VALUES(
					code,
					_username,
					_password,
					_email,
					_security_code,
					null::character varying,
					_user_personal_data_code, 
					_status_code,
					_role_code
				);
		end if;
	END;]]> </definition>
</procedure>

<view name="view_region" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="4840"/>
	<reference>
		<expression> <![CDATA[ SELECT r.code,
    r.name
   FROM region r;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="50"/>
	</column>
		<reftable name="public.region"/>
	</reference>
</view>

<relationship name="rel_view_region_region" type="reltv" layers="0"
	 custom-color="#dbdbfe"
	 src-table="public.view_region"
	 dst-table="public.region"
	 src-required="false" dst-required="false"/>

<view name="view_stade" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="360" y="4840"/>
	<reference>
		<expression> <![CDATA[ SELECT s.code,
    s.name,
    s.region_code AS "regionCode"
   FROM stade s;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
	<column name="regionCode">
		<type name="character varying" length="15"/>
	</column>
		<reftable name="public.stade"/>
	</reference>
</view>

<relationship name="rel_view_stade_stade" type="reltv" layers="0"
	 custom-color="#ef3f1c"
	 src-table="public.view_stade"
	 dst-table="public.stade"
	 src-required="false" dst-required="false"/>

<view name="view_municipality" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="700" y="4840"/>
	<reference>
		<expression> <![CDATA[ SELECT m.code,
    m.name,
    m.stade_code AS "stadeCode"
   FROM municipality m;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="60"/>
	</column>
	<column name="stadeCode">
		<type name="character varying" length="15"/>
	</column>
		<reftable name="public.municipality"/>
	</reference>
</view>

<relationship name="rel_view_municipality_municipality" type="reltv" layers="0"
	 custom-color="#1bc040"
	 src-table="public.view_municipality"
	 dst-table="public.municipality"
	 src-required="false" dst-required="false"/>

<view name="view_parrish" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1040" y="4840"/>
	<reference>
		<expression> <![CDATA[ SELECT p.code,
    p.name,
    p.municipality_code AS "municipalityCode"
   FROM parrish p;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="60"/>
	</column>
	<column name="municipalityCode">
		<type name="character varying" length="15"/>
	</column>
		<reftable name="public.parrish"/>
	</reference>
</view>

<relationship name="rel_view_parrish_parrish" type="reltv" layers="0"
	 custom-color="#a0ae12"
	 src-table="public.view_parrish"
	 dst-table="public.parrish"
	 src-required="false" dst-required="false"/>

<view name="view_documentType" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1420" y="4840"/>
	<reference>
		<expression> <![CDATA[ SELECT dt.code,
    dt.name,
    dt.acronym
   FROM document_type dt;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
	<column name="acronym">
		<type name="character" length="1"/>
	</column>
		<reftable name="public.document_type"/>
	</reference>
</view>

<relationship name="&quot;rel_view_documentType_document_type&quot;" type="reltv" layers="0"
	 custom-color="#44480d"
	 src-table="public.&quot;view_documentType&quot;"
	 dst-table="public.document_type"
	 src-required="false" dst-required="false"/>

<view name="view_martialStatus" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="5040"/>
	<reference>
		<expression> <![CDATA[ SELECT ms.code,
    ms.name
   FROM martial_status ms;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
		<reftable name="public.martial_status"/>
	</reference>
</view>

<relationship name="&quot;rel_view_martialStatus_martial_status&quot;" type="reltv" layers="0"
	 custom-color="#0e6149"
	 src-table="public.&quot;view_martialStatus&quot;"
	 dst-table="public.martial_status"
	 src-required="false" dst-required="false"/>

<view name="view_disability" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="360" y="5040"/>
	<reference>
		<expression> <![CDATA[ SELECT dt.code,
    dt.name
   FROM disability_type dt;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
		<reftable name="public.disability_type"/>
	</reference>
</view>

<relationship name="rel_view_disability_disability_type" type="reltv" layers="0"
	 custom-color="#1098d5"
	 src-table="public.view_disability"
	 dst-table="public.disability_type"
	 src-required="false" dst-required="false"/>

<view name="view_departament" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="660" y="5040"/>
	<reference>
		<expression> <![CDATA[ SELECT d.code,
    d.name
   FROM departament d;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="50"/>
	</column>
		<reftable name="public.departament"/>
	</reference>
</view>

<relationship name="rel_view_departament_departament" type="reltv" layers="0"
	 custom-color="#aab0c2"
	 src-table="public.view_departament"
	 dst-table="public.departament"
	 src-required="false" dst-required="false"/>

<view name="view_jobPosition" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="960" y="5040"/>
	<reference>
		<expression> <![CDATA[ SELECT jp.code,
    jp.name
   FROM job_position jp;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="50"/>
	</column>
		<reftable name="public.job_position"/>
	</reference>
</view>

<relationship name="&quot;rel_view_jobPosition_job_position&quot;" type="reltv" layers="0"
	 custom-color="#89ad9a"
	 src-table="public.&quot;view_jobPosition&quot;"
	 dst-table="public.job_position"
	 src-required="false" dst-required="false"/>

<procedure name="add_employed" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_user_personal_data_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_job_position_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_departament_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_date_of_entry">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_date_of_discharge">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatafirstname">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatalastname">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatagendercode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_usepersonaldatadocumenttypecode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatadni">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldataborndate">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatamartialstatuscode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatadisability">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatadisabilitytypecode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldataethnicgroup">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_userpersonaldataethnicdesciption">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldataparrishcode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatadirection">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldataphonenumber">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	declare 
		code character varying;
		code_type character varying := 'EMPL';
		upd_code character varying;
		upd_code_type character varying := 'upd';
		exist_upd int;	
	begin
		code := codegen(code_type);
	
		if _user_personal_data_code is null then
			select count(*) into exist_upd from public.user_personal_data where dni = _userpersonaldatadni;
	
			if exist_upd > 0 then
				raise exception 'cedula regristrada' USING HINT = 'EXCEPTION is raised here and transaction aborted';
			end if;
		
			upd_code := codegen(upd_code_type);
		
			insert into public.user_personal_data (
				code,
				first_name,
				last_name,
				gender_code, 
				document_type_code,
				dni,
				born_date,
				martial_status_code,
				disability,
				disability_type_code,
				ethnic_group,
				ethnic_description,
				parrish_code,
				direction,
				phone_number
			) values (
				upd_code,
				_userpersonaldatafirstname,
				_userpersonaldatalastname,
				_userpersonaldatagendercode, 
				_usepersonaldatadocumenttypecode,
				_userpersonaldatadni,
				_userpersonaldataborndate,	
				_userpersonaldatamartialstatuscode,
				_userpersonaldatadisability,
				_userpersonaldatadisabilitytypecode,
				_userpersonaldataethnicgroup,
				_userpersonaldataethnicdesciption,
				_userPersonalDataParrishCode,
				_userpersonaldatadirection,
				_userpersonaldataphonenumber
			);
			insert into public.employed 
			(code,user_personal_data_code,date_of_entry,date_of_discharge,job_position_code,departament_code)
			values
			(
			code,
			upd_code,
			_date_of_entry,
			_date_of_discharge,
			_job_position_code,
			_departament_code
			);
		else 
		
			insert into public.employed 
			(code,user_personal_data_code,date_of_entry,date_of_discharge,job_position_code,departament_code)
			values
			(
			code,
			_user_personal_data_code,
			_date_of_entry,
			_date_of_discharge,
			_job_position_code,
			_departament_code
			);
	
		end if;
		
	
	END;]]> </definition>
</procedure>

<procedure name="update_employed" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_userpersonaldatacode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_employedcode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_job_position_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_departament_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_date_of_entry">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_date_of_discharge">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatafirstname">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatalastname">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatagendercode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_usepersonaldatadocumenttypecode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatadni">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldataborndate">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatamartialstatuscode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatadisability">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatadisabilitytypecode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldataethnicgroup">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_userpersonaldataethnicdesciption">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldataparrishcode">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldatadirection">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_userpersonaldataphonenumber">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	declare 
		code character varying;
		code_type character varying := 'EMPL';
		upd_code character varying;
		upd_code_type character varying := 'upd';
		exist_upd int;	
	begin
		
			update public."user_personal_data"
			set 
				first_name = _userpersonaldatafirstname,
				last_name = _userpersonaldatalastname,
				gender_code = _userpersonaldatagendercode, 
				document_type_code = _usepersonaldatadocumenttypecode,
				dni = _userpersonaldatadni,
				born_date = _userpersonaldataborndate,
				martial_status_code = _userpersonaldatamartialstatuscode,
				disability = _userpersonaldatadisability,
				disability_type_code = _userpersonaldatadisabilitytypecode,
				ethnic_group = _userpersonaldataethnicgroup,
				ethnic_description = _userpersonaldataethnicdesciption,
				parrish_code = _userPersonalDataParrishCode,
				direction = _userpersonaldatadirection,
				phone_number = _userpersonaldataphonenumber
			where public.user_personal_data."code" = _userpersonaldatacode;
		
			update public."employed" 
			set 
			user_personal_data_code = _userpersonaldatacode ,
			date_of_entry = _date_of_entry ,
			date_of_discharge = _date_of_discharge,
			job_position_code = _job_position_code,
			departament_code = _departament_code
			where public.employed."code" = _employedCode;
	
		
	
	END;]]> </definition>
</procedure>

<view name="view_user_personal_data" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1260" y="5040"/>
	<reference>
		<expression> <![CDATA[ SELECT upd.code,
    upd.first_name AS "firstName",
    upd.last_name AS "lastName",
    upd.gender_code AS "genderCode",
    upd.document_type_code AS "documentTypeCode",
    dt.name AS "documentTypeName",
    dt.acronym AS "documentTypeAcronym",
    upd.dni,
    upd.born_date AS "bornDate",
    upd.martial_status_code AS "martialStatusCode",
    upd.disability,
    upd.disability_type_code AS "disabilityTypeCode",
    upd.ethnic_group AS "ethnicGroup",
    upd.ethnic_description AS "ethnicDescription",
    upd.parrish_code AS "parrishCode",
    m.code AS "municipalityCode",
    s.code AS "stadeCode",
    r.code AS "regionCode",
    upd.direction,
    upd.phone_number AS "phoneNumber"
   FROM (((((user_personal_data upd
     JOIN parrish p ON (((upd.parrish_code)::text = (p.code)::text)))
     JOIN document_type dt ON (((upd.document_type_code)::text = (dt.code)::text)))
     JOIN municipality m ON (((p.municipality_code)::text = (m.code)::text)))
     JOIN stade s ON (((m.stade_code)::text = (s.code)::text)))
     JOIN region r ON (((s.region_code)::text = (r.code)::text)));]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="firstName">
		<type name="character varying" length="50"/>
	</column>
	<column name="lastName">
		<type name="character varying" length="50"/>
	</column>
	<column name="genderCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="documentTypeCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="documentTypeName">
		<type name="character varying" length="20"/>
	</column>
	<column name="documentTypeAcronym">
		<type name="character" length="1"/>
	</column>
	<column name="dni">
		<type name="character varying" length="14"/>
	</column>
	<column name="bornDate">
		<type name="date" length="0"/>
	</column>
	<column name="martialStatusCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="disability">
		<type name="boolean" length="0"/>
	</column>
	<column name="disabilityTypeCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="ethnicGroup">
		<type name="boolean" length="0"/>
	</column>
	<column name="ethnicDescription">
		<type name="character varying" length="60"/>
	</column>
	<column name="parrishCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="municipalityCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="stadeCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="regionCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="direction">
		<type name="character varying" length="150"/>
	</column>
	<column name="phoneNumber">
		<type name="character varying" length="15"/>
	</column>
		<reftable name="public.document_type"/>
		<reftable name="public.stade"/>
		<reftable name="public.municipality"/>
		<reftable name="public.parrish"/>
		<reftable name="public.user_personal_data"/>
		<reftable name="public.region"/>
	</reference>
</view>

<relationship name="rel_view_user_personal_data_document_type" type="reltv" layers="0"
	 custom-color="#d3d799"
	 src-table="public.view_user_personal_data"
	 dst-table="public.document_type"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_user_personal_data_stade" type="reltv" layers="0"
	 custom-color="#941dc6"
	 src-table="public.view_user_personal_data"
	 dst-table="public.stade"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_user_personal_data_municipality" type="reltv" layers="0"
	 custom-color="#629b22"
	 src-table="public.view_user_personal_data"
	 dst-table="public.municipality"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_user_personal_data_parrish" type="reltv" layers="0"
	 custom-color="#cc6b89"
	 src-table="public.view_user_personal_data"
	 dst-table="public.parrish"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_user_personal_data_user_personal_data" type="reltv" layers="0"
	 custom-color="#f1f068"
	 src-table="public.view_user_personal_data"
	 dst-table="public.user_personal_data"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_user_personal_data_region" type="reltv" layers="0"
	 custom-color="#8027cc"
	 src-table="public.view_user_personal_data"
	 dst-table="public.region"
	 src-required="false" dst-required="false"/>

<view name="view_user_roles" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="5640"/>
	<reference>
		<expression> <![CDATA[ SELECT ur.code,
    ur.name
   FROM users_role ur;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="50"/>
	</column>
		<reftable name="public.users_role"/>
	</reference>
</view>

<relationship name="rel_view_user_roles_users_role" type="reltv" layers="0"
	 custom-color="#cfc8a7"
	 src-table="public.view_user_roles"
	 dst-table="public.users_role"
	 src-required="false" dst-required="false"/>

<view name="view_user_status" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="360" y="5640"/>
	<reference>
		<expression> <![CDATA[ SELECT us.code,
    us.name
   FROM users_status us;]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="50"/>
	</column>
		<reftable name="public.users_status"/>
	</reference>
</view>

<relationship name="rel_view_user_status_users_status" type="reltv" layers="0"
	 custom-color="#27dc54"
	 src-table="public.view_user_status"
	 dst-table="public.users_status"
	 src-required="false" dst-required="false"/>

<procedure name="update_user" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_user_personal_data_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_user_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_username">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_password">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_email">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_security_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_status_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_role_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_first_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_last_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_gender_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_document_type_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_dni">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_born_date">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_martial_status_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_disability">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_disability_type_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_ethnic_group">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_ethnic_description">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_parrish_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_direction">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_phone_number">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	begin
		if _password is not null and _security_code is not null then
			update public.users set
				username = _username,
				"password" = _password,
				email = _email,
				security_code = _security_code,
				recuperate_password_token = null::character varying,
				status_code = _status_code,
				role_code = _role_code
				where code = _user_code;
		else
			update public.users set
				username = _username,
				email = _email,
				recuperate_password_token = null::character varying,
				status_code = _status_code,
				role_code = _role_code
				where code = _user_code;
		end if;
	
	update public.user_personal_data set
			first_name = _first_name,
			last_name = _last_name,
			gender_code = _gender_code, 
			document_type_code = _document_type_code,
			dni =_dni,
			born_date = _born_date,
			martial_status_code = _martial_status_code,
			disability = _disability,
			disability_type_code = _disability_type_code,
			ethnic_group = _ethnic_group,
			ethnic_description = _ethnic_description,
			parrish_code = _parrish_code,
			direction = _direction,
			phone_number = _phone_number
			where code = _user_personal_data_code;
		
		
	END;]]> </definition>
</procedure>

<view name="view_employed" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="660" y="5640"/>
	<reference>
		<expression> <![CDATA[ SELECT e.code,
    upd.code AS "personalDataCode",
    e.job_position_code AS "jobPositionCode",
    jp.name AS "jobPositionName",
    e.departament_code AS "departamentCode",
    d.name AS "departamentName",
    e.date_of_entry AS "dateOfEntry",
    e.date_of_discharge AS "dateOfDischarge",
    upd.first_name AS "firstName",
    upd.last_name AS "lastName",
    upd.gender_code AS "genderCode",
    upd.document_type_code AS "documentTypeCode",
    upd.dni,
    upd.born_date AS "bornDate",
    upd.martial_status_code AS "martialStatusCode",
    upd.disability,
    upd.disability_type_code AS "disabilitiTypeCode",
    upd.ethnic_group AS "ethnicGroup",
    upd.ethnic_description AS "ethnicDescrption",
    upd.parrish_code AS "parrishCode",
    m.code AS "municipalityCode",
    s.code AS "stadeCode",
    r.code AS "regionCode",
    upd.direction,
    upd.phone_number AS "phoneNumber"
   FROM (((((((employed e
     JOIN user_personal_data upd ON (((e.user_personal_data_code)::text = (upd.code)::text)))
     JOIN job_position jp ON (((e.job_position_code)::text = (jp.code)::text)))
     JOIN departament d ON (((e.departament_code)::text = (d.code)::text)))
     JOIN parrish p ON (((upd.parrish_code)::text = (p.code)::text)))
     JOIN municipality m ON (((p.municipality_code)::text = (m.code)::text)))
     JOIN stade s ON (((m.stade_code)::text = (s.code)::text)))
     JOIN region r ON (((s.region_code)::text = (r.code)::text)));]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="personalDataCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="jobPositionCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="jobPositionName">
		<type name="character varying" length="50"/>
	</column>
	<column name="departamentCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="departamentName">
		<type name="character varying" length="50"/>
	</column>
	<column name="dateOfEntry">
		<type name="date" length="0"/>
	</column>
	<column name="dateOfDischarge">
		<type name="date" length="0"/>
	</column>
	<column name="firstName">
		<type name="character varying" length="50"/>
	</column>
	<column name="lastName">
		<type name="character varying" length="50"/>
	</column>
	<column name="genderCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="documentTypeCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="dni">
		<type name="character varying" length="14"/>
	</column>
	<column name="bornDate">
		<type name="date" length="0"/>
	</column>
	<column name="martialStatusCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="disability">
		<type name="boolean" length="0"/>
	</column>
	<column name="disabilitiTypeCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="ethnicGroup">
		<type name="boolean" length="0"/>
	</column>
	<column name="ethnicDescrption">
		<type name="character varying" length="60"/>
	</column>
	<column name="parrishCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="municipalityCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="stadeCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="regionCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="direction">
		<type name="character varying" length="150"/>
	</column>
	<column name="phoneNumber">
		<type name="character varying" length="15"/>
	</column>
		<reftable name="public.stade"/>
		<reftable name="public.municipality"/>
		<reftable name="public.parrish"/>
		<reftable name="public.user_personal_data"/>
		<reftable name="public.employed"/>
		<reftable name="public.job_position"/>
		<reftable name="public.departament"/>
		<reftable name="public.region"/>
	</reference>
</view>

<relationship name="rel_view_employed_stade" type="reltv" layers="0"
	 custom-color="#ac0736"
	 src-table="public.view_employed"
	 dst-table="public.stade"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_employed_municipality" type="reltv" layers="0"
	 custom-color="#e29524"
	 src-table="public.view_employed"
	 dst-table="public.municipality"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_employed_parrish" type="reltv" layers="0"
	 custom-color="#80f3a1"
	 src-table="public.view_employed"
	 dst-table="public.parrish"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_employed_user_personal_data" type="reltv" layers="0"
	 custom-color="#089aff"
	 src-table="public.view_employed"
	 dst-table="public.user_personal_data"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_employed_employed" type="reltv" layers="0"
	 custom-color="#c5de2b"
	 src-table="public.view_employed"
	 dst-table="public.employed"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_employed_job_position" type="reltv" layers="0"
	 custom-color="#8fa52c"
	 src-table="public.view_employed"
	 dst-table="public.job_position"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_employed_departament" type="reltv" layers="0"
	 custom-color="#99e781"
	 src-table="public.view_employed"
	 dst-table="public.departament"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_employed_region" type="reltv" layers="0"
	 custom-color="#516af9"
	 src-table="public.view_employed"
	 dst-table="public.region"
	 src-required="false" dst-required="false"/>

<procedure name="add_module" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_src">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_icon">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_order">
		<type name="integer" length="0"/>
	</parameter>
	<parameter name="_unabled">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_has_children">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_father_code">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	declare 
		code character varying;
		code_type character varying := 'module';
	BEGIN
		code := codegen(code_type);
		insert into public."modules" (
			code,
			name,
			src,
			icon,
			"order",
			unabled,
			haschildren,
			fathercode 
		) values (
			code,
			_name,
			_src,
			_icon,
			_order,
			_unabled,
			_has_children,
			_father_code
		);
	END;]]> </definition>
</procedure>

<procedure name="update_module" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_src">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_icon">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_order">
		<type name="integer" length="0"/>
	</parameter>
	<parameter name="_unabled">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_has_children">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_father_code">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[	BEGIN
		update public."modules" set
			name = _name,
			src = _src,
			icon = _icon,
			"order" = _order,
			unabled = _unabled,
			haschildren = _has_children,
			fathercode = _father_code
			where code = _code;
		
	END;]]> </definition>
</procedure>

<view name="view_modules" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1060" y="5640"/>
	<reference>
		<expression> <![CDATA[ SELECT (NULLIF(regexp_replace((m.code)::text, '[A-Z-]'::text, ''::text, 'g'::text), ''::text))::integer AS "codeR",
    m.code,
    m.fathercode AS "fatherCode",
    m.name,
    m.src,
    m.icon,
    m."order",
    m.unabled,
    m.haschildren AS "hasChildren"
   FROM modules m
  ORDER BY (NULLIF(regexp_replace((m.code)::text, '[A-Z-]'::text, ''::text, 'g'::text), ''::text))::integer, m."order";]]> </expression>
	<column name="codeR">
		<type name="integer" length="0"/>
	</column>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="fatherCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="50"/>
	</column>
	<column name="src">
		<type name="character varying" length="50"/>
	</column>
	<column name="icon">
		<type name="character varying" length="50"/>
	</column>
	<column name="order">
		<type name="integer" length="0"/>
	</column>
	<column name="unabled">
		<type name="boolean" length="0"/>
	</column>
	<column name="hasChildren">
		<type name="boolean" length="0"/>
	</column>
		<reftable name="public.modules"/>
	</reference>
</view>

<relationship name="rel_view_modules_modules" type="reltv" layers="0"
	 custom-color="#5bcc5c"
	 src-table="public.view_modules"
	 dst-table="public.modules"
	 src-required="false" dst-required="false"/>

<view name="view_permissions" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1420" y="5640"/>
	<reference>
		<expression> <![CDATA[ SELECT mp."moduleCode",
    mp."moduleName",
    mp."moduleSrc",
    mp."moduleIcon",
    mp."roleCode",
    mp."roleName",
    mp."jobPositionCode",
    mp."jobPositionName",
    mp."departamentCode",
    mp."departamentName",
    mp."hasChildren",
    mp."order",
    mp."fatherCode",
    mp.show,
    mp."create",
    mp.update,
    mp.print,
    mp.report
   FROM ( SELECT m.code AS "moduleCode",
            m.name AS "moduleName",
            m.src AS "moduleSrc",
            m.icon AS "moduleIcon",
            (ur.code)::character varying AS "roleCode",
            (ur.name)::character varying AS "roleName",
            NULL::character varying AS "jobPositionCode",
            NULL::character varying AS "jobPositionName",
            NULL::character varying AS "departamentCode",
            NULL::character varying AS "departamentName",
            m.haschildren AS "hasChildren",
            m."order",
            m.fathercode AS "fatherCode",
            rmp.show,
            rmp."create",
            rmp.update,
            rmp.print,
            rmp.report
           FROM ((modules m
             JOIN role_module_permission rmp ON (((rmp.module_code)::text = (m.code)::text)))
             JOIN users_role ur ON (((rmp.role_code)::text = (ur.code)::text)))
        UNION
         SELECT m2.code AS "moduleCode",
            m2.name AS "moduleName",
            m2.src AS "moduleSrc",
            m2.icon AS "moduleIcon",
            NULL::character varying AS "roleCode",
            NULL::character varying AS "roleName",
            (jp.code)::character varying AS "jobPositionCode",
            (jp.name)::character varying AS "jobPositionName",
            (d.code)::character varying AS "departamentCode",
            (d.name)::character varying AS "departamentName",
            m2.haschildren,
            m2."order",
            m2.fathercode AS "fatherCode",
            mbjpd.show,
            mbjpd."create",
            mbjpd.update,
            mbjpd.print,
            mbjpd.report
           FROM (((modules m2
             JOIN modules_by_job_position_departament mbjpd ON (((mbjpd.module_code)::text = (m2.code)::text)))
             JOIN departament d ON (((mbjpd.departament_code)::text = (d.code)::text)))
             JOIN job_position jp ON (((mbjpd.job_position_code)::text = (jp.code)::text)))) mp
  ORDER BY mp."moduleCode", mp."order";]]> </expression>
	<column name="moduleCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="moduleName">
		<type name="character varying" length="50"/>
	</column>
	<column name="moduleSrc">
		<type name="character varying" length="50"/>
	</column>
	<column name="moduleIcon">
		<type name="character varying" length="50"/>
	</column>
	<column name="roleCode">
		<type name="character varying" length="0"/>
	</column>
	<column name="roleName">
		<type name="character varying" length="0"/>
	</column>
	<column name="jobPositionCode">
		<type name="character varying" length="0"/>
	</column>
	<column name="jobPositionName">
		<type name="character varying" length="0"/>
	</column>
	<column name="departamentCode">
		<type name="character varying" length="0"/>
	</column>
	<column name="departamentName">
		<type name="character varying" length="0"/>
	</column>
	<column name="hasChildren">
		<type name="boolean" length="0"/>
	</column>
	<column name="order">
		<type name="integer" length="0"/>
	</column>
	<column name="fatherCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="show">
		<type name="boolean" length="0"/>
	</column>
	<column name="create">
		<type name="boolean" length="0"/>
	</column>
	<column name="update">
		<type name="boolean" length="0"/>
	</column>
	<column name="print">
		<type name="boolean" length="0"/>
	</column>
	<column name="report">
		<type name="boolean" length="0"/>
	</column>
		<reftable name="public.users_role"/>
		<reftable name="public.role_module_permission"/>
		<reftable name="public.modules"/>
		<reftable name="public.job_position"/>
		<reftable name="public.departament"/>
		<reftable name="public.modules_by_job_position_departament"/>
	</reference>
</view>

<relationship name="rel_view_permissions_users_role" type="reltv" layers="0"
	 custom-color="#78a884"
	 src-table="public.view_permissions"
	 dst-table="public.users_role"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_permissions_role_module_permission" type="reltv" layers="0"
	 custom-color="#48ede5"
	 src-table="public.view_permissions"
	 dst-table="public.role_module_permission"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_permissions_modules" type="reltv" layers="0"
	 custom-color="#ae2ef9"
	 src-table="public.view_permissions"
	 dst-table="public.modules"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_permissions_job_position" type="reltv" layers="0"
	 custom-color="#4da5e7"
	 src-table="public.view_permissions"
	 dst-table="public.job_position"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_permissions_departament" type="reltv" layers="0"
	 custom-color="#722087"
	 src-table="public.view_permissions"
	 dst-table="public.departament"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_permissions_modules_by_job_position_departament" type="reltv" layers="0"
	 custom-color="#26f20c"
	 src-table="public.view_permissions"
	 dst-table="public.modules_by_job_position_departament"
	 src-required="false" dst-required="false"/>

<procedure name="add_sponsor" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_contac_number">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_email">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_document_type_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_rif">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[declare 
	code character varying;
	code_type character varying := 'spns';
	rif_exist int := 0;
begin
	select count(*) into rif_exist 
	from public.sponsors where rif = _rif;
	if rif_exist > 0 then
	    RAISE EXCEPTION  'el rif ya existe' USING HINT = 'EXCEPTION is raised here and transaction aborted';
	end if;
	code := codegen(code_type);
	INSERT INTO public.sponsors(
		 code,
		 name,
		 contac_number,
		 email,
		 document_type_code,
		 rif)
		VALUES (
	       	code,
	        _name,
	        _contac_number,
	        _email,
	        _document_type_code,
	        _rif
	    );
	    
end;]]> </definition>
</procedure>

<procedure name="update_sponsor" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_contact_number">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_email">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_document_type_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_rif">
		<type name="character varying" length="0"/>
	</parameter>
	<definition> <![CDATA[begin
	
	update public.sponsors set
		 "name" = _name,
		 contac_number = _contact_number,
		 email = _email,
		 document_type_code = _document_type_code,
		 rif = _rif
		 where code = _code;
	    
end;]]> </definition>
</procedure>

<view name="view_users" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="60" y="6360"/>
	<reference>
		<expression> <![CDATA[ SELECT users.code,
    users.username,
    users.password,
    users.email,
    users.security_code AS "userSecurityCode",
    users.recuperate_password_token AS "recuperatePasswordToken",
    users.personal_data_code AS "personalDataCode",
    upd.first_name AS "firstName",
    upd.last_name AS "lastName",
    upd.gender_code AS "genderCode",
    g.name AS "genderName",
    upd.document_type_code AS "documentTypeCode",
    document_type.name AS "documentTypeName",
    document_type.acronym AS "documentTypeAcronym",
    upd.dni,
    upd.born_date AS "bornDate",
    upd.martial_status_code AS "martialStatusCode",
    ms.name AS "martialStatusName",
    upd.disability,
    upd.disability_type_code AS "disabilityTypeCode",
    dt.name AS "disabilityTypeName",
    upd.ethnic_group AS "ethnicGroup",
    upd.ethnic_description AS "ethnicDescription",
    upd.parrish_code AS "parrishCode",
    p.name AS "parrishName",
    m.code AS "municipalityCode",
    m.name AS "municipalityName",
    s.code AS "stadeCode",
    s.name AS "stadeName",
    r.code AS "regionCode",
    r.name AS "regionName",
    upd.direction,
    upd.phone_number AS "phoneNumber",
    users.status_code AS "statusCode",
    us.name AS "statusName",
    users.role_code AS "roleCode",
    ur.name AS "roleName",
        CASE
            WHEN (e.date_of_discharge IS NULL) THEN e.departament_code
            ELSE NULL::character varying
        END AS "departamentCode",
        CASE
            WHEN (e.date_of_discharge IS NULL) THEN d.name
            ELSE NULL::character varying
        END AS "departamentName",
        CASE
            WHEN (e.date_of_discharge IS NULL) THEN e.job_position_code
            ELSE NULL::character varying
        END AS "jobPositionCode",
        CASE
            WHEN (e.date_of_discharge IS NULL) THEN jp.name
            ELSE NULL::character varying
        END AS "jobPositionName"
   FROM ((((((((((((((users
     JOIN user_personal_data upd ON (((users.personal_data_code)::text = (upd.code)::text)))
     JOIN gender g ON (((upd.gender_code)::text = (g.code)::text)))
     JOIN document_type ON (((upd.document_type_code)::text = (document_type.code)::text)))
     JOIN martial_status ms ON (((upd.martial_status_code)::text = (ms.code)::text)))
     LEFT JOIN disability_type dt ON (((upd.disability_type_code)::text = (dt.code)::text)))
     JOIN parrish p ON (((upd.parrish_code)::text = (p.code)::text)))
     JOIN municipality m ON (((p.municipality_code)::text = (m.code)::text)))
     JOIN stade s ON (((m.stade_code)::text = (s.code)::text)))
     JOIN region r ON (((s.region_code)::text = (r.code)::text)))
     JOIN users_status us ON (((users.status_code)::text = (us.code)::text)))
     JOIN users_role ur ON (((users.role_code)::text = (ur.code)::text)))
     LEFT JOIN employed e ON (((upd.code)::text = (e.user_personal_data_code)::text)))
     LEFT JOIN job_position jp ON (((e.job_position_code)::text = (jp.code)::text)))
     LEFT JOIN departament d ON (((e.departament_code)::text = (d.code)::text)));]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="username">
		<type name="character varying" length="30"/>
	</column>
	<column name="password">
		<type name="character varying" length="150"/>
	</column>
	<column name="email">
		<type name="character varying" length="150"/>
	</column>
	<column name="userSecurityCode">
		<type name="character varying" length="150"/>
	</column>
	<column name="recuperatePasswordToken">
		<type name="character varying" length="50"/>
	</column>
	<column name="personalDataCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="firstName">
		<type name="character varying" length="50"/>
	</column>
	<column name="lastName">
		<type name="character varying" length="50"/>
	</column>
	<column name="genderCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="genderName">
		<type name="character varying" length="20"/>
	</column>
	<column name="documentTypeCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="documentTypeName">
		<type name="character varying" length="20"/>
	</column>
	<column name="documentTypeAcronym">
		<type name="character" length="1"/>
	</column>
	<column name="dni">
		<type name="character varying" length="14"/>
	</column>
	<column name="bornDate">
		<type name="date" length="0"/>
	</column>
	<column name="martialStatusCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="martialStatusName">
		<type name="character varying" length="20"/>
	</column>
	<column name="disability">
		<type name="boolean" length="0"/>
	</column>
	<column name="disabilityTypeCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="disabilityTypeName">
		<type name="character varying" length="20"/>
	</column>
	<column name="ethnicGroup">
		<type name="boolean" length="0"/>
	</column>
	<column name="ethnicDescription">
		<type name="character varying" length="60"/>
	</column>
	<column name="parrishCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="parrishName">
		<type name="character varying" length="60"/>
	</column>
	<column name="municipalityCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="municipalityName">
		<type name="character varying" length="60"/>
	</column>
	<column name="stadeCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="stadeName">
		<type name="character varying" length="20"/>
	</column>
	<column name="regionCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="regionName">
		<type name="character varying" length="50"/>
	</column>
	<column name="direction">
		<type name="character varying" length="150"/>
	</column>
	<column name="phoneNumber">
		<type name="character varying" length="15"/>
	</column>
	<column name="statusCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="statusName">
		<type name="character varying" length="50"/>
	</column>
	<column name="roleCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="roleName">
		<type name="character varying" length="50"/>
	</column>
	<column name="departamentCode">
		<type name="character varying" length="0"/>
	</column>
	<column name="departamentName">
		<type name="character varying" length="0"/>
	</column>
	<column name="jobPositionCode">
		<type name="character varying" length="0"/>
	</column>
	<column name="jobPositionName">
		<type name="character varying" length="0"/>
	</column>
		<reftable name="public.users"/>
		<reftable name="public.users_status"/>
		<reftable name="public.users_role"/>
		<reftable name="public.document_type"/>
		<reftable name="public.gender"/>
		<reftable name="public.martial_status"/>
		<reftable name="public.disability_type"/>
		<reftable name="public.stade"/>
		<reftable name="public.municipality"/>
		<reftable name="public.parrish"/>
		<reftable name="public.user_personal_data"/>
		<reftable name="public.employed"/>
		<reftable name="public.job_position"/>
		<reftable name="public.departament"/>
		<reftable name="public.region"/>
	</reference>
</view>

<relationship name="rel_view_users_users" type="reltv" layers="0"
	 custom-color="#19e074"
	 src-table="public.view_users"
	 dst-table="public.users"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_users_status" type="reltv" layers="0"
	 custom-color="#4b646b"
	 src-table="public.view_users"
	 dst-table="public.users_status"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_users_role" type="reltv" layers="0"
	 custom-color="#bed52c"
	 src-table="public.view_users"
	 dst-table="public.users_role"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_document_type" type="reltv" layers="0"
	 custom-color="#1975d4"
	 src-table="public.view_users"
	 dst-table="public.document_type"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_gender" type="reltv" layers="0"
	 custom-color="#30068f"
	 src-table="public.view_users"
	 dst-table="public.gender"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_martial_status" type="reltv" layers="0"
	 custom-color="#1edd54"
	 src-table="public.view_users"
	 dst-table="public.martial_status"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_disability_type" type="reltv" layers="0"
	 custom-color="#656b4d"
	 src-table="public.view_users"
	 dst-table="public.disability_type"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_stade" type="reltv" layers="0"
	 custom-color="#6f7e6a"
	 src-table="public.view_users"
	 dst-table="public.stade"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_municipality" type="reltv" layers="0"
	 custom-color="#71a680"
	 src-table="public.view_users"
	 dst-table="public.municipality"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_parrish" type="reltv" layers="0"
	 custom-color="#8d4ec3"
	 src-table="public.view_users"
	 dst-table="public.parrish"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_user_personal_data" type="reltv" layers="0"
	 custom-color="#948970"
	 src-table="public.view_users"
	 dst-table="public.user_personal_data"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_employed" type="reltv" layers="0"
	 custom-color="#9783b8"
	 src-table="public.view_users"
	 dst-table="public.employed"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_job_position" type="reltv" layers="0"
	 custom-color="#b9e395"
	 src-table="public.view_users"
	 dst-table="public.job_position"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_departament" type="reltv" layers="0"
	 custom-color="#d23d33"
	 src-table="public.view_users"
	 dst-table="public.departament"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_users_region" type="reltv" layers="0"
	 custom-color="#ec7af0"
	 src-table="public.view_users"
	 dst-table="public.region"
	 src-required="false" dst-required="false"/>

<procedure name="add_project" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_acronym">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_startDate">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_dueDate">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_minYearsOlds">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_maxYearsOlds">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_fromDay">
		<type name="character" length="0"/>
	</parameter>
	<parameter name="_toDay">
		<type name="character" length="0"/>
	</parameter>
	<parameter name="_oneDay">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_sponsor">
		<type name="character varying" length="0" dimension="1"/>
	</parameter>
	<definition> <![CDATA[DECLARE
code character varying;
code_type character varying := 'prjt';
BEGIN
    
    code := codegen(code_type,_acronym);
    
    
    INSERT INTO public.project(
	code,
    name,
    acronym,
    start_date,
    due_date,
    min_years_old,
    max_years_old,
    from_day,
    to_day,
    one_day
    )
	VALUES (
        code,
        "_name",
        "_acronym",
        "_startDate",
        "_dueDate",
        "_minYearsOlds",
        "_maxYearsOlds",
        "_fromDay",
        "_toDay",
        "_oneDay"
    );
    insert into public.sponsors_by_project(project_code,sponsor_code)
    select code, * from unnest("_sponsor");
END;]]> </definition>
</procedure>

<view name="view_sponsor" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="500" y="6360"/>
	<reference>
		<expression> <![CDATA[ SELECT sp.code,
    dt.code AS "documentTypeCode",
    dt.name AS "documentTypeName",
    dt.acronym,
    sp.rif,
    sp.name,
    sp.contac_number AS "contactNumber",
    sp.email
   FROM (sponsors sp
     JOIN document_type dt ON (((dt.code)::text = (sp.document_type_code)::text)));]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="documentTypeCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="documentTypeName">
		<type name="character varying" length="20"/>
	</column>
	<column name="acronym">
		<type name="character" length="1"/>
	</column>
	<column name="rif">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
	<column name="contactNumber">
		<type name="character varying" length="20"/>
	</column>
	<column name="email">
		<type name="character varying" length="50"/>
	</column>
		<reftable name="public.document_type"/>
		<reftable name="public.sponsors"/>
	</reference>
</view>

<relationship name="rel_view_sponsor_document_type" type="reltv" layers="0"
	 custom-color="#6f0131"
	 src-table="public.view_sponsor"
	 dst-table="public.document_type"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_sponsor_sponsors" type="reltv" layers="0"
	 custom-color="#62a609"
	 src-table="public.view_sponsor"
	 dst-table="public.sponsors"
	 src-required="false" dst-required="false"/>

<view name="view_sponsor_by_project" layers="0" collapse-mode="2" max-obj-count="1" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="900" y="6360"/>
	<reference>
		<expression> <![CDATA[ SELECT s.code,
    sbp.project_code AS "projectCode",
    s.name,
    s.email,
    sbp.delete
   FROM (sponsors_by_project sbp
     JOIN sponsors s ON (((s.code)::text = (sbp.sponsor_code)::text)))
  WHERE (sbp.delete = false);]]> </expression>
	<column name="code">
		<type name="character varying" length="15"/>
	</column>
	<column name="projectCode">
		<type name="character varying" length="15"/>
	</column>
	<column name="name">
		<type name="character varying" length="20"/>
	</column>
	<column name="email">
		<type name="character varying" length="50"/>
	</column>
	<column name="delete">
		<type name="boolean" length="0"/>
	</column>
		<reftable name="public.sponsors"/>
		<reftable name="public.sponsors_by_project"/>
	</reference>
</view>

<relationship name="rel_view_sponsor_by_project_sponsors" type="reltv" layers="0"
	 custom-color="#f4b62c"
	 src-table="public.view_sponsor_by_project"
	 dst-table="public.sponsors"
	 src-required="false" dst-required="false"/>

<relationship name="rel_view_sponsor_by_project_sponsors_by_project" type="reltv" layers="0"
	 custom-color="#13e451"
	 src-table="public.view_sponsor_by_project"
	 dst-table="public.sponsors_by_project"
	 src-required="false" dst-required="false"/>

<procedure name="update_project" security-type="SECURITY INVOKER">
	<schema name="public"/>
	<role name="krash"/>
	<language name="plpgsql"/>
	<parameter name="_code">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_name">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_acronym">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_startDate">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_dueDate">
		<type name="date" length="0"/>
	</parameter>
	<parameter name="_minYearsOlds">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_maxYearsOlds">
		<type name="character varying" length="0"/>
	</parameter>
	<parameter name="_fromDay">
		<type name="character" length="0"/>
	</parameter>
	<parameter name="_toDay">
		<type name="character" length="0"/>
	</parameter>
	<parameter name="_oneDay">
		<type name="boolean" length="0"/>
	</parameter>
	<parameter name="_sponsor">
		<type name="character varying" length="0" dimension="1"/>
	</parameter>
	<parameter name="_sponsor_delete">
		<type name="boolean" length="0" dimension="1"/>
	</parameter>
	<definition> <![CDATA[BEGIN
    update public.project set (
    name,
    acronym,
    start_date,
    due_date,
    min_years_old,
    max_years_old,
    from_day,
    to_day,
    one_day
    ) = (
	_name,
	_acronym,
	"_startDate",
	"_dueDate" ,
	"_minYearsOlds",
	"_maxYearsOlds",
	"_fromDay" ,
	"_toDay" ,
	"_oneDay") where code = _code;
	
	insert into public.sponsors_by_project(project_code,sponsor_code,"delete") select * from (SELECT _code, *  FROM 
		unnest(_sponsor,_sponsor_delete)) as v(project_code,sponsor_code, "delete")
		on conflict on constraint "sponsors_by_project_uk" do update 
			set "delete" = EXCLUDED."delete";
END;]]> </definition>
</procedure>

<table name="mobilization_condition" layers="0" collapse-mode="2" max-obj-count="12" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1440" y="3720"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1">
		<type name="bigint" length="0"/>
	</column>
	<column name="patient_code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="refugee">
		<type name="boolean" length="0"/>
	</column>
	<column name="pendulum_movement">
		<type name="boolean" length="0"/>
	</column>
	<column name="displaced">
		<type name="boolean" length="0"/>
	</column>
	<column name="intention_to_emigrate">
		<type name="boolean" length="0"/>
	</column>
	<column name="returnee">
		<type name="boolean" length="0"/>
	</column>
	<column name="none">
		<type name="boolean" length="0"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="mobilization_condition_pk" type="pk-constr" table="public.mobilization_condition">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="mobilization_condition_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="9223372036854775807" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<table name="patient_relationship" layers="0" collapse-mode="2" max-obj-count="6" z-value="0">
	<schema name="public"/>
	<role name="krash"/>
	<position x="1920" y="3720"/>
	<column name="id" not-null="true"
	 identity-type="ALWAYS" start="1" increment="1" min-value="1" max-value="32767" cache="1">
		<type name="smallint" length="0"/>
	</column>
	<column name="code" not-null="true">
		<type name="character varying" length="15"/>
	</column>
	<column name="name" not-null="true">
		<type name="character varying" length="20"/>
	</column>
	<column name="create_at" default-value="now()">
		<type name="timestamp" length="0"/>
	</column>
	<column name="update_at">
		<type name="timestamp" length="0"/>
	</column>
	<constraint name="patient_relationship_pk" type="pk-constr" table="public.patient_relationship">
		<columns names="id" ref-type="src-columns"/>
	</constraint>
	<constraint name="patient_relationship_uk" type="uq-constr" table="public.patient_relationship">
		<columns names="code" ref-type="src-columns"/>
	</constraint>
</table>

<sequence name="patient_relationship_id_seq" cycle="false" start="1" increment="1" min-value="1" max-value="32767" cache="1" sql-disabled="true">
	<schema name="public"/>
	<role name="krash"/>
</sequence>

<constraint name="users_fk_personal_data" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.user_personal_data" table="public.users">
	<columns names="personal_data_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="users_fk_roles" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.users_role" table="public.users">
	<columns names="role_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="users_fk_status" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.users_status" table="public.users">
	<columns names="status_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="role_module_permission_fk_roles" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.users_role" table="public.role_module_permission">
	<columns names="role_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="role_module_permission_fk_modules" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.modules" table="public.role_module_permission">
	<columns names="module_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="representative_fk_document_type" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.document_type" table="public.representative">
	<columns names="document_type_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="representative_fk_gender" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.gender" table="public.representative">
	<columns names="gender_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="representative_fk_martial_status" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.martial_status" table="public.representative">
	<columns names="martial_status_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="representative_fk_disability" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.disability_type" table="public.representative">
	<columns names="disability_type_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="representative_fk_parrish" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.parrish" table="public.representative">
	<columns names="parrish_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="patient_fk_gender" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.gender" table="public.patient">
	<columns names="gender_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="patient_fk_parrish" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.parrish" table="public.patient">
	<columns names="parrish_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="stade_fk_region" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.region" table="public.stade">
	<columns names="region_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="municipality_fk_stade" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.stade" table="public.municipality">
	<columns names="stade_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="parrish_fk_municipality" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.municipality" table="public.parrish">
	<columns names="municipality_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="clinic_history_fk_patient" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.patient" table="public.clinic_history">
	<columns names="patient_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="clinic_history_fk_project" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.project" table="public.clinic_history">
	<columns names="project_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="reception_agenda_fk_clinicHistory" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.clinic_history" table="public.reception_agenda">
	<columns names="clinic_history_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="reception_agenda_fk_project" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.project" table="public.reception_agenda">
	<columns names="project_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="nursing_fk_clinic_history" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.clinic_history" table="public.nursing">
	<columns names="clinic_history_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="nursing_fk_sizes" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.sizes" table="public.nursing">
	<columns names="sizes_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="nursing_fk_" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.weight" table="public.nursing">
	<columns names="weight_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="nursing_fk_exit_status" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.exit_status" table="public.nursing">
	<columns names="exit_status_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="3phase_fk_clinic_history" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.clinic_history" table="public.&quot;3phase&quot;">
	<columns names="clinic_history_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="3phase_fk_grown_monitoring" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.grown_monitoring_status" table="public.&quot;3phase&quot;">
	<columns names="growth_monitoring_status_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="babysitter_fk_patient" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.patient" table="public.babysitter">
	<columns names="patient_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="babysitter_fk_representative" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.representative" table="public.babysitter">
	<columns names="representative_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="babysitter_fk_relationship" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.patient_relationship" table="public.babysitter">
	<columns names="relationship_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="patient_disability_fk_patient" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.patient" table="public.patient_disability">
	<columns names="patient_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="sponsors_fk_documentType" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.document_type" table="public.sponsors">
	<columns names="document_type_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="sponsors_by_project_fk_spnsr" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="NO ACTION" del-action="NO ACTION" ref-table="public.sponsors" table="public.sponsors_by_project">
	<columns names="sponsor_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="sponsors_by_project_fk_prjct" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.project" table="public.sponsors_by_project">
	<columns names="project_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="user_personal_data_fk_document_type" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.document_type" table="public.user_personal_data">
	<columns names="document_type_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="user_personal_data_fk_gender" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.gender" table="public.user_personal_data">
	<columns names="gender_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="user_personal_data_fk_martial_status" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.martial_status" table="public.user_personal_data">
	<columns names="martial_status_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="user_personal_data_fk_disability" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.disability_type" table="public.user_personal_data">
	<columns names="disability_type_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="user_personal_data_fk_parrish" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.parrish" table="public.user_personal_data">
	<columns names="parrish_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="employed_fk_personal_data" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.user_personal_data" table="public.employed">
	<columns names="user_personal_data_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="employed_fk_job_position" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.job_position" table="public.employed">
	<columns names="job_position_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="employed_pk_departament" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.departament" table="public.employed">
	<columns names="departament_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="modules_by_job_position_departament_fk_module" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.modules" table="public.modules_by_job_position_departament">
	<columns names="module_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="modules_by_job_position_departament_fk_job_position" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.job_position" table="public.modules_by_job_position_departament">
	<columns names="job_position_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="modules_by_job_position_departament_fk_departament" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.departament" table="public.modules_by_job_position_departament">
	<columns names="departament_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<constraint name="mobilization_condition_fk_patient" type="fk-constr" comparison-type="MATCH SIMPLE"
	 upd-action="RESTRICT" del-action="RESTRICT" ref-table="public.patient" table="public.mobilization_condition">
	<columns names="patient_code" ref-type="src-columns"/>
	<columns names="code" ref-type="dst-columns"/>
</constraint>

<relationship name="rel_users_user_personal_data" type="relfk" layers="0"
	 custom-color="#413a4c"
	 src-table="public.users"
	 dst-table="public.user_personal_data" reference-fk="users_fk_personal_data"
	 src-required="false" dst-required="false"/>

<relationship name="rel_users_users_role" type="relfk" layers="0"
	 custom-color="#08dc1b"
	 src-table="public.users"
	 dst-table="public.users_role" reference-fk="users_fk_roles"
	 src-required="false" dst-required="true"/>

<relationship name="rel_users_users_status" type="relfk" layers="0"
	 custom-color="#887953"
	 src-table="public.users"
	 dst-table="public.users_status" reference-fk="users_fk_status"
	 src-required="false" dst-required="false"/>

<relationship name="rel_role_module_permission_users_role" type="relfk" layers="0"
	 custom-color="#cd2706"
	 src-table="public.role_module_permission"
	 dst-table="public.users_role" reference-fk="role_module_permission_fk_roles"
	 src-required="false" dst-required="true"/>

<relationship name="rel_role_module_permission_modules" type="relfk" layers="0"
	 custom-color="#24b74e"
	 src-table="public.role_module_permission"
	 dst-table="public.modules" reference-fk="role_module_permission_fk_modules"
	 src-required="false" dst-required="true"/>

<relationship name="rel_representative_document_type" type="relfk" layers="0"
	 custom-color="#d8ce7d"
	 src-table="public.representative"
	 dst-table="public.document_type" reference-fk="representative_fk_document_type"
	 src-required="false" dst-required="true"/>

<relationship name="rel_representative_gender" type="relfk" layers="0"
	 custom-color="#50080f"
	 src-table="public.representative"
	 dst-table="public.gender" reference-fk="representative_fk_gender"
	 src-required="false" dst-required="true"/>

<relationship name="rel_representative_martial_status" type="relfk" layers="0"
	 custom-color="#43e4b1"
	 src-table="public.representative"
	 dst-table="public.martial_status" reference-fk="representative_fk_martial_status"
	 src-required="false" dst-required="true"/>

<relationship name="rel_representative_disability_type" type="relfk" layers="0"
	 custom-color="#16a3e5"
	 src-table="public.representative"
	 dst-table="public.disability_type" reference-fk="representative_fk_disability"
	 src-required="false" dst-required="false"/>

<relationship name="rel_representative_parrish" type="relfk" layers="0"
	 custom-color="#8ca83f"
	 src-table="public.representative"
	 dst-table="public.parrish" reference-fk="representative_fk_parrish"
	 src-required="false" dst-required="true"/>

<relationship name="rel_patient_gender" type="relfk" layers="0"
	 custom-color="#e48378"
	 src-table="public.patient"
	 dst-table="public.gender" reference-fk="patient_fk_gender"
	 src-required="false" dst-required="true"/>

<relationship name="rel_patient_parrish" type="relfk" layers="0"
	 custom-color="#f46e7b"
	 src-table="public.patient"
	 dst-table="public.parrish" reference-fk="patient_fk_parrish"
	 src-required="false" dst-required="false"/>

<relationship name="rel_stade_region" type="relfk" layers="0"
	 custom-color="#9adfda"
	 src-table="public.stade"
	 dst-table="public.region" reference-fk="stade_fk_region"
	 src-required="false" dst-required="true"/>

<relationship name="rel_municipality_stade" type="relfk" layers="0"
	 custom-color="#1676fd"
	 src-table="public.municipality"
	 dst-table="public.stade" reference-fk="municipality_fk_stade"
	 src-required="false" dst-required="true"/>

<relationship name="rel_parrish_municipality" type="relfk" layers="0"
	 custom-color="#9a5c32"
	 src-table="public.parrish"
	 dst-table="public.municipality" reference-fk="parrish_fk_municipality"
	 src-required="false" dst-required="true"/>

<relationship name="rel_clinic_history_patient" type="relfk" layers="0"
	 custom-color="#59f794"
	 src-table="public.clinic_history"
	 dst-table="public.patient" reference-fk="clinic_history_fk_patient"
	 src-required="false" dst-required="false"/>

<relationship name="rel_clinic_history_project" type="relfk" layers="0"
	 custom-color="#fc1922"
	 src-table="public.clinic_history"
	 dst-table="public.project" reference-fk="clinic_history_fk_project"
	 src-required="false" dst-required="false"/>

<relationship name="rel_reception_agenda_clinic_history" type="relfk" layers="0"
	 custom-color="#6a91d9"
	 src-table="public.reception_agenda"
	 dst-table="public.clinic_history" reference-fk="reception_agenda_fk_clinicHistory"
	 src-required="false" dst-required="false"/>

<relationship name="rel_reception_agenda_project" type="relfk" layers="0"
	 custom-color="#7f091c"
	 src-table="public.reception_agenda"
	 dst-table="public.project" reference-fk="reception_agenda_fk_project"
	 src-required="false" dst-required="false"/>

<relationship name="rel_nursing_clinic_history" type="relfk" layers="0"
	 custom-color="#11c7fd"
	 src-table="public.nursing"
	 dst-table="public.clinic_history" reference-fk="nursing_fk_clinic_history"
	 src-required="false" dst-required="false"/>

<relationship name="rel_nursing_sizes" type="relfk" layers="0"
	 custom-color="#4e0554"
	 src-table="public.nursing"
	 dst-table="public.sizes" reference-fk="nursing_fk_sizes"
	 src-required="false" dst-required="true"/>

<relationship name="rel_nursing_weight" type="relfk" layers="0"
	 custom-color="#f581f9"
	 src-table="public.nursing"
	 dst-table="public.weight" reference-fk="nursing_fk_"
	 src-required="false" dst-required="true"/>

<relationship name="rel_nursing_exit_status" type="relfk" layers="0"
	 custom-color="#c1360b"
	 src-table="public.nursing"
	 dst-table="public.exit_status" reference-fk="nursing_fk_exit_status"
	 src-required="false" dst-required="false"/>

<relationship name="rel_3phase_clinic_history" type="relfk" layers="0"
	 custom-color="#1d6cac"
	 src-table="public.&quot;3phase&quot;"
	 dst-table="public.clinic_history" reference-fk="3phase_fk_clinic_history"
	 src-required="false" dst-required="false"/>

<relationship name="rel_3phase_grown_monitoring_status" type="relfk" layers="0"
	 custom-color="#b476b4"
	 src-table="public.&quot;3phase&quot;"
	 dst-table="public.grown_monitoring_status" reference-fk="3phase_fk_grown_monitoring"
	 src-required="false" dst-required="false"/>

<relationship name="rel_babysitter_patient" type="relfk" layers="0"
	 custom-color="#5e76fe"
	 src-table="public.babysitter"
	 dst-table="public.patient" reference-fk="babysitter_fk_patient"
	 src-required="false" dst-required="false"/>

<relationship name="rel_babysitter_representative" type="relfk" layers="0"
	 custom-color="#247d22"
	 src-table="public.babysitter"
	 dst-table="public.representative" reference-fk="babysitter_fk_representative"
	 src-required="false" dst-required="false"/>

<relationship name="rel_babysitter_patient_relationship" type="relfk" layers="0"
	 custom-color="#97f477"
	 src-table="public.babysitter"
	 dst-table="public.patient_relationship" reference-fk="babysitter_fk_relationship"
	 src-required="false" dst-required="true"/>

<relationship name="rel_patient_disability_patient" type="relfk" layers="0"
	 custom-color="#8d3f33"
	 src-table="public.patient_disability"
	 dst-table="public.patient" reference-fk="patient_disability_fk_patient"
	 src-required="false" dst-required="true"/>

<relationship name="rel_sponsors_document_type" type="relfk" layers="0"
	 custom-color="#9a483f"
	 src-table="public.sponsors"
	 dst-table="public.document_type" reference-fk="sponsors_fk_documentType"
	 src-required="false" dst-required="true"/>

<relationship name="rel_sponsors_by_project_sponsors" type="relfk" layers="0"
	 custom-color="#1c8b86"
	 src-table="public.sponsors_by_project"
	 dst-table="public.sponsors" reference-fk="sponsors_by_project_fk_spnsr"
	 src-required="false" dst-required="true"/>

<relationship name="rel_sponsors_by_project_project" type="relfk" layers="0"
	 custom-color="#34adc8"
	 src-table="public.sponsors_by_project"
	 dst-table="public.project" reference-fk="sponsors_by_project_fk_prjct"
	 src-required="false" dst-required="true"/>

<relationship name="rel_user_personal_data_document_type" type="relfk" layers="0"
	 custom-color="#032847"
	 src-table="public.user_personal_data"
	 dst-table="public.document_type" reference-fk="user_personal_data_fk_document_type"
	 src-required="false" dst-required="true"/>

<relationship name="rel_user_personal_data_gender" type="relfk" layers="0"
	 custom-color="#66610a"
	 src-table="public.user_personal_data"
	 dst-table="public.gender" reference-fk="user_personal_data_fk_gender"
	 src-required="false" dst-required="true"/>

<relationship name="rel_user_personal_data_martial_status" type="relfk" layers="0"
	 custom-color="#c3f50f"
	 src-table="public.user_personal_data"
	 dst-table="public.martial_status" reference-fk="user_personal_data_fk_martial_status"
	 src-required="false" dst-required="true"/>

<relationship name="rel_user_personal_data_disability_type" type="relfk" layers="0"
	 custom-color="#5bd2d3"
	 src-table="public.user_personal_data"
	 dst-table="public.disability_type" reference-fk="user_personal_data_fk_disability"
	 src-required="false" dst-required="false"/>

<relationship name="rel_user_personal_data_parrish" type="relfk" layers="0"
	 custom-color="#93de2f"
	 src-table="public.user_personal_data"
	 dst-table="public.parrish" reference-fk="user_personal_data_fk_parrish"
	 src-required="false" dst-required="true"/>

<relationship name="rel_employed_user_personal_data" type="relfk" layers="0"
	 custom-color="#c9955c"
	 src-table="public.employed"
	 dst-table="public.user_personal_data" reference-fk="employed_fk_personal_data"
	 src-required="false" dst-required="true"/>

<relationship name="rel_employed_job_position" type="relfk" layers="0"
	 custom-color="#881d94"
	 src-table="public.employed"
	 dst-table="public.job_position" reference-fk="employed_fk_job_position"
	 src-required="false" dst-required="true"/>

<relationship name="rel_employed_departament" type="relfk" layers="0"
	 custom-color="#293f60"
	 src-table="public.employed"
	 dst-table="public.departament" reference-fk="employed_pk_departament"
	 src-required="false" dst-required="true"/>

<relationship name="rel_modules_by_job_position_departament_modules" type="relfk" layers="0"
	 custom-color="#358e27"
	 src-table="public.modules_by_job_position_departament"
	 dst-table="public.modules" reference-fk="modules_by_job_position_departament_fk_module"
	 src-required="false" dst-required="true"/>

<relationship name="rel_modules_by_job_position_departament_job_position" type="relfk" layers="0"
	 custom-color="#3a2fb2"
	 src-table="public.modules_by_job_position_departament"
	 dst-table="public.job_position" reference-fk="modules_by_job_position_departament_fk_job_position"
	 src-required="false" dst-required="true"/>

<relationship name="rel_modules_by_job_position_departament_departament" type="relfk" layers="0"
	 custom-color="#cdc765"
	 src-table="public.modules_by_job_position_departament"
	 dst-table="public.departament" reference-fk="modules_by_job_position_departament_fk_departament"
	 src-required="false" dst-required="true"/>

<relationship name="rel_mobilization_condition_patient" type="relfk" layers="0"
	 custom-color="#15b53f"
	 src-table="public.mobilization_condition"
	 dst-table="public.patient" reference-fk="mobilization_condition_fk_patient"
	 src-required="false" dst-required="true"/>

<permission>
	<object name="public" type="schema"/>
	<roles names="krash"/>
	<privileges create="true" usage="true"/>
</permission>
<permission>
	<object name="public" type="schema"/>
	<privileges create="true" usage="true"/>
</permission>
</dbmodel>
